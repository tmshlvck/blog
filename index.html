
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://tmshlvck.github.io/blog/">
      
      
      
        <link rel="next" href="archive/2025/">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Brill's techblog</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#blog" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Brill&#39;s techblog" class="md-header__button md-logo" aria-label="Brill's techblog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Brill's techblog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Blog
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Brill&#39;s techblog" class="md-nav__button md-logo" aria-label="Brill's techblog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Brill's techblog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
      
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2021/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2021
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2019/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2019
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2016/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2016
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2015/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2014/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2014
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2013
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2012/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2012
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2011/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2011
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2010/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2010
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="blog">Blog</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-12-04 23:00:00+01:00">December 4, 2025</time></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="fixing-mt7615e-wifi-card-with-missing-eeprom-on-banana-pi-r4"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/">Fixing MT7615E WiFi card with missing EEPROM on Banana Pi R4</a></h2>
<h3 id="the-problem"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#the-problem">The Problem</a></h3>
<p>I have a <a href="https://docs.banana-pi.org/en/BPI-MT7615/BananaPi_MT7615">Banana Pi BPI-MT7615 802.11 ac WiFi card</a> installed in my Banana Pi R4 running Armbian:</p>
<pre><code>$ lspci
0000:00:00.0 PCI bridge: MEDIATEK Corp. MT7988 PCI Express Host Bridge [Filogic 880] (rev 01)
0000:01:00.0 Unclassified device [0002]: MEDIATEK Corp. MT7615E 802.11ac PCI Express Wireless Network Adapter
</code></pre>
<p>The card was recognized and the driver loaded, but there was a serious issue: TX power was stuck at 3 dBm regardless of what I tried to set:</p>
<pre><code>$ sudo iw phy0 set txpower fixed 2000  # trying to set 20 dBm
$ sudo iw dev
phy#0
        Interface wlp1s0
...
                txpower 3.00 dBm    # still 3 dBm!
</code></pre>
<p>This made the card practically useless - 3 dBm is about 2 milliwatts, barely enough to reach the next room.</p>
<h3 id="root-cause"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#root-cause">Root Cause</a></h3>
<p>After some research, I found the culprit: My MT7615E card lacks an onboard EEPROM chip. The EEPROM contains calibration data including TX power limits for each channel and band. Without it, the mt76 driver falls back to minimal safe defaults - hence the 3 dBm limit.</p>
<p>This is a known issue with certain MT7615E development boards and cheap cards. The relevant discussions:</p>
<ul>
<li><a href="https://forum.openwrt.org/t/tx-power-with-mt76-driver/155933">OpenWRT Forum: TX power with mt76 driver</a></li>
<li><a href="https://forum.banana-pi.org/t/802-11ac-module-gives-max-6dbi-transmitter-power/14238/22">Banana Pi Forum: 802.11ac module gives max 6dBi transmitter power</a></li>
</ul>
<h3 id="the-solution"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#the-solution">The Solution</a></h3>
<p>The fix requires two components:</p>
<ol>
<li>A kernel patch that allows the mt76 driver to load EEPROM data from a file</li>
<li>An appropriate EEPROM binary file with proper calibration data</li>
</ol>
<h4 id="kernel-patch"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#kernel-patch">Kernel Patch</a></h4>
<p>Frank Wunderlich created a patch for the BPI-Router-Linux kernel that adds filesystem-based EEPROM loading. The original patch is available at <a href="https://github.com/frank-w/BPI-Router-Linux/commit/fe31dae2ab5c2fbd39b6609845920969d10dd465">Frank-W's BPI-Router-Linux repository</a>.</p>
<p>I adapted this patch for the Armbian build system targeting kernel 6.16. The patch adds a <code>mt76_get_eeprom_file()</code> function that looks for EEPROM data at <code>/lib/firmware/mediatek/{driver}_rf.bin</code>. For MT7615E, this means <code>/lib/firmware/mediatek/mt7615e_rf.bin</code>.</p>
<p>The patch is available in my Armbian fork: <a href="https://github.com/tmshlvck/armbian-build/tree/bpir4">tmshlvck/armbian-build bpir4 branch</a></p>
<p>Specifically:</p>
<ul>
<li><a href="https://github.com/tmshlvck/armbian-build/blob/bpir4/patch/kernel/archive/filogic-6.16/patches.armbian/0085-mt76-add-eeprom-file-loading-support.patch">The patch file</a></li>
<li><a href="https://github.com/tmshlvck/armbian-build/blob/bpir4/patch/kernel/archive/filogic-6.16/series.conf">series.conf with the patch included</a></li>
</ul>
<h4 id="eeprom-binary-file"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#eeprom-binary-file">EEPROM Binary File</a></h4>
<p>You need a working EEPROM image for your card. I'm providing the one that works for my MT7615E card with unlocked power limits:</p>
<p><strong>Download:</strong> <a href="files/mt7615e_rf.bin">mt7615e_rf.bin</a> (19880 bytes)</p>
<p>Alternative sources for EEPROM files:</p>
<ul>
<li><a href="https://github.com/ericwoud/buildR64ubuntu/tree/master/linux-5.16-rc3/firmware/mediatek">Eric Woud's buildR64ubuntu firmware</a> - contains various mt76 EEPROM files</li>
<li>Extract from another MT7615E card with working EEPROM via its factory MTD partition</li>
</ul>
<h3 id="installation"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#installation">Installation</a></h3>
<h4 id="1-build-armbian-with-the-patch"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#1-build-armbian-with-the-patch">1. Build Armbian with the patch</a></h4>
<p>Clone my Armbian fork and build:</p>
<pre><code class="language-bash">git clone -b bpir4 https://github.com/tmshlvck/armbian-build.git
cd armbian-build
./compile.sh BOARD=bananapi-r4 BRANCH=edge kernel
</code></pre>
<p>Or apply the patch manually to your own Armbian build.</p>
<h4 id="2-install-the-eeprom-file"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#2-install-the-eeprom-file">2. Install the EEPROM file</a></h4>
<p>Copy the EEPROM binary to the target system:</p>
<pre><code class="language-bash">sudo mkdir -p /lib/firmware/mediatek/
sudo cp mt7615e_rf.bin /lib/firmware/mediatek/
</code></pre>
<h4 id="3-reboot-and-verify"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#3-reboot-and-verify">3. Reboot and verify</a></h4>
<p>After rebooting, check dmesg for successful EEPROM loading:</p>
<pre><code class="language-bash">dmesg | grep -i eeprom
</code></pre>
<p>You should see something like:</p>
<pre><code>mt7615e 0000:01:00.0: Load eeprom: /lib/firmware/mediatek/mt7615e_rf.bin
mt7615e 0000:01:00.0: Load eeprom OK, count 19880 byte
</code></pre>
<p>Now verify TX power can be set properly:</p>
<pre><code class="language-bash">sudo iw phy0 set txpower fixed 2000  # 20 dBm
sudo iw dev
</code></pre>
<p>The interface should now show the requested TX power (within regulatory limits).</p>
<h3 id="technical-details"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#technical-details">Technical Details</a></h3>
<p>The patch works by modifying <code>drivers/net/wireless/mediatek/mt76/eeprom.c</code> to try loading EEPROM from filesystem before falling back to device tree or NVMEM sources. The file path is constructed as <code>/lib/firmware/mediatek/{driver_name}_rf.bin</code>, where <code>driver_name</code> comes from the kernel driver (e.g., <code>mt7615e</code>, <code>mt7915e</code>, etc.).</p>
<p>This approach was proposed upstream but wasn't merged as OpenWRT prefers device tree based solutions. However, for development boards and cards without factory-programmed EEPROM, the filesystem approach is practical and flexible.</p>
<h3 id="important-notes"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#important-notes">Important Notes</a></h3>
<ul>
<li>Different EEPROM files may have different regulatory domain settings affecting available channels and power levels</li>
<li>The EEPROM contains calibration data specific to the hardware - using wrong data could result in suboptimal performance or regulatory violations</li>
<li>This patch is not upstream in mainline Linux or Armbian; you'll need to maintain it yourself or use my fork</li>
</ul>
<h3 id="references"><a class="toclink" href="2025/12/04/2025-12-mt7615e-eeprom-bpir4/#references">References</a></h3>
<ul>
<li><a href="https://github.com/openwrt/mt76/issues/949">OpenWRT mt76 Issue #949: MT7615 eeprom binary from filesystem</a></li>
<li><a href="https://github.com/frank-w/BPI-Router-Linux">Frank Wunderlich's BPI-Router-Linux</a></li>
<li><a href="https://github.com/tmshlvck/armbian-build/tree/bpir4">My Armbian fork with the patch</a></li>
<li><a href="https://wiki.banana-pi.org/Banana_Pi_BPI-R4">Banana Pi BPI-R4 Wiki</a></li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-02-09 13:00:00+02:00">February 9, 2025</time></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="prefix-delegation-broken-with-systemd-network-and-upcsunrisech-supplied-arris-modem"><a class="toclink" href="2025/02/09/2025-02-arris-pd/">Prefix Delegation broken with systemd-network and UPC/Sunrise(CH)-supplied Arris modem</a></h2>
<h3 id="ipv6-home-network"><a class="toclink" href="2025/02/09/2025-02-arris-pd/#ipv6-home-network">IPv6 home network</a></h3>
<p>Networking is not a fun anymore, they said. Noone wants to do networking, they said.</p>
<p>Well, yes, IPv4 is obsolete and dull even without the great evil of all times - NAT.
But I am using IPv6 for fun and profit for years now, so everything is fine, right? Nope. IPv6 is stil a second class citizen for most
of the ISPs. Many software developers hardly understand the basics of networking and they make the apps working empirically and iteratively.
IPv6 is left broken in many cases because there is still supposed to be a fallback to IPv4 - "happy eyeballs".</p>
<p>And yes, v6 is indeed more complex in certain aspects.</p>
<p>Look at the prefix delegation: Is it necessary to run large access network? No, in most cases.
Does it promise more flexibility than static routes? Sure. And everybody is using it! Just join the bandwagon...</p>
<h3 id="funny-modem"><a class="toclink" href="2025/02/09/2025-02-arris-pd/#funny-modem">Funny modem</a></h3>
<p>That brings me to THE MODEM. I got it from UPC/Sunrise few years ago when I got the service in the suburbs of Zurich. It is
in fact a heavily locked-down and branded version of Arris TG3492LG-LC.</p>
<p><img alt="Modem Arris TG3492LG-LC" src="images/IMG_20250212_230513.jpg" /></p>
<h3 id="pd-going-wrong-with-systemd-networkd"><a class="toclink" href="2025/02/09/2025-02-arris-pd/#pd-going-wrong-with-systemd-networkd">PD going wrong with <code>systemd-networkd</code></a></h3>
<p>On the receiving end is just a current Debian stable (bookworm) running on Turris Omnia (armhf) board. Nothing fancy. I configured
<code>systemd-networkd</code> with the following <code>/etc/systemd/network/end2.network</code>:</p>
<pre><code>[Match]
Name=end2

[Network]
KeepConfiguration=yes
Address=192.168.1.2/24
Gateway=192.168.1.1
LinkLocalAddressing=ipv6
IPv6AcceptRA=yes
ConfigureWithoutCarrier=true

[IPv6AcceptRA]
DHCPv6Client=always

[DHCPv6]
PrefixDelegationHint=::/60
</code></pre>
<p>And I had corresponding config so I can use the delegated prefix on <code>br0</code>:</p>
<pre><code>[Match]
Name=br0

[Network]
ConfigureWithoutCarrier=yes
LinkLocalAddressing=ipv6
Address=192.168.8.1/24
DHCPPrefixDelegation=yes
IPv6SendRA=yes
IPv6AcceptRA=no

[DHCPPrefixDelegation]
UplinkInterface=end2
SubnetId=0x0
Announce=yes

[IPv6SendRA]
EmitDNS=yes
DNS=2606:4700:4700::1111
DNS=2001:4860:4860::8888
</code></pre>
<p>Which worked to a certain extent. Sometimes (say that 1 in 2 or 3 tries succeeded so I got the delegated prefix on <code>br0</code>). But astonishingly I
was also randomly loosing the delegated prefix within 5-15 minutes after I obtained it. So I configured <code>systemd-networkd</code>
debugging in <code>/etc/systemd/system/systemd-networkd.service.d/10-debug.conf</code> :</p>
<pre><code>[Service]
Environment=SYSTEMD_LOG_LEVEL=debug
</code></pre>
<h3 id="systemd-networkd-debug"><a class="toclink" href="2025/02/09/2025-02-arris-pd/#systemd-networkd-debug">systemd-networkd debug</a></h3>
<p>Two observations in the log:</p>
<p>1) the T1 and T2 for the delegated prefix are unusually short (5 and 10 seconds).</p>
<p>2) It seems that the lost delegation is caused by a malformed message sent by the modem when the <code>systemd-networkd</code> misses the T2 renew
deadline and has to rebind the PD instead (see Feb 09 11:30:23).</p>
<pre><code>Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Requesting NDisc route (configuring,configured): dst: 2a02:aa11:380:300::/57, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Route prefix is ::/0, ignoring
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Setting SLAAC addresses and router.
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: Timeout T1
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: State changed: bound -&gt; renew
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Configuring NDisc route (requesting,configuring,configured): dst: n/a, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Configuring NDisc route (requesting,configuring,configured): dst: 2a02:aa11:380:300::/64, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Configuring NDisc address (requesting,configured): 2a02:aa11:380:300:da58:d7ff:fe00:19f3/64 (valid for 1w 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: manage-temporary-address,no-prefixroute, scope: global
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Configuring NDisc route (requesting,configuring,configured): dst: 2a02:aa11:380:300::/57, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: Sent Renew
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: Next retransmission in 9s
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: ndisc_check_ready(): SLAAC addresses and routes are not set.
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: ndisc_check_ready(): SLAAC addresses and routes are not set.
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: Received updated NDisc address (configured): 2a02:aa11:380:300:da58:d7ff:fe00:19f3/64 (valid for 1w 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: manage-temporary-address,no-prefixroute, scope: global
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: ndisc_check_ready(): SLAAC addresses and routes are not set.
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: SLAAC addresses and routes set.
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: Processed Reply message
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: T1 expires in 4s
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: T2 expires in 9s
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: Valid lifetime expires in 3h
Feb 09 11:29:05 slepice systemd-networkd[12922]: end2: DHCPv6 client: State changed: renew -&gt; bound
...
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Timeout T1
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: State changed: bound -&gt; renew
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Timeout T2
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: State changed: renew -&gt; rebind
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Sent Rebind
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Next retransmission in 9s
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Received an IA option without valid IA addresses or PD prefixes, ignoring.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Failed to parse IA_PD option, ignoring: No data available
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Processed Reply message
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: T1 expires in 2d 3h 25min 40s
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: T2 expires in 3d 6h 17min 36s
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: Valid lifetime expires in 4d 11h 52min 41s
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 client: State changed: rebind -&gt; bound
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 address 2a02:aa11:380:300::d6f1/128 (valid for 4d 11h 52min 40s, preferred for 4d 11h 52min 40s)
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Requesting DHCPv6 address (configured): 2a02:aa11:380:300::d6f1/128 (valid for 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: no-prefixroute, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: br0: Removing DHCP-PD address (configured): 2a02:aa11:380:310:ac58:60ff:fe6b:cd2e/64 (valid for 2h 59min 50s, preferred for 1h 59min 50s), flags: manage-temporary-address, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: Sent message type=signal sender=n/a destination=n/a path=/org/freedesktop/network1/link/_310 interface=org.freedesktop.DBus.Properties member=PropertiesChanged cookie=79 reply_cookie=0 signature=sa{sv}as error-name=n/a error-message=n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: Removing DHCPv6 route (configuring,configured): dst: 2a02:aa11:380:310::/60, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: main(254), proto: dhcp, type: unreachable, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Setting DHCPv6 addresses and routes
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Configuring DHCPv6 address (requesting,configured): 2a02:aa11:380:300::d6f1/128 (valid for 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: no-prefixroute, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: br0: Forgetting DHCP-PD address (n/a): 2a02:aa11:380:310:ac58:60ff:fe6b:cd2e/64 (valid for 2h 59min 49s, preferred for 1h 59min 49s), flags: manage-temporary-address, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: br0: Forgetting foreign route (n/a): dst: 2a02:aa11:380:310::/128, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: local(255), proto: kernel, type: anycast, nexthop: 0, priority: 0, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: br0: Forgetting foreign route (n/a): dst: 2a02:aa11:380:310:ac58:60ff:fe6b:cd2e/128, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: local(255), proto: kernel, type: local, nexthop: 0, priority: 0, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: Removed DHCPv6 route (configuring): dst: 2a02:aa11:380:310::/60, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: main(254), proto: dhcp, type: unreachable, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Received updated DHCPv6 address (configured): 2a02:aa11:380:300::d6f1/128 (valid for 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: no-prefixroute, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: DHCPv6 addresses and routes set.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: NDISC: Received Router Advertisement: flags OTHER preference medium lifetime 1800 sec
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: NDISC: Invoking callback for 'router' event.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Acquiring DHCPv6 lease on NDisc request
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Requesting NDisc route (configuring,configured): dst: n/a, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Requesting NDisc route (configuring,configured): dst: 2a02:aa11:380:300::/64, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Requesting NDisc address (configured): 2a02:aa11:380:300:da58:d7ff:fe00:19f3/64 (valid for 1w 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: manage-temporary-address,no-prefixroute, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Requesting NDisc route (configuring,configured): dst: 2a02:aa11:380:300::/57, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Route prefix is ::/0, ignoring
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Setting SLAAC addresses and router.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Configuring NDisc route (requesting,configuring,configured): dst: n/a, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Configuring NDisc route (requesting,configuring,configured): dst: 2a02:aa11:380:300::/64, src: n/a, gw: n/a, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Configuring NDisc address (requesting,configured): 2a02:aa11:380:300:da58:d7ff:fe00:19f3/64 (valid for 1w 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: manage-temporary-address,no-prefixroute, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Configuring NDisc route (requesting,configuring,configured): dst: 2a02:aa11:380:300::/57, src: n/a, gw: fe80::aef8:ccff:fe64:3975, prefsrc: n/a, scope: global, table: main(254), proto: ra, type: unicast, nexthop: 0, priority: 1024, flags: n/a
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: ndisc_check_ready(): SLAAC addresses and routes are not set.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: ndisc_check_ready(): SLAAC addresses and routes are not set.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: Received updated NDisc address (configured): 2a02:aa11:380:300:da58:d7ff:fe00:19f3/64 (valid for 1w 4d 11h 52min 40s, preferred for 4d 11h 52min 40s), flags: manage-temporary-address,no-prefixroute, scope: global
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: ndisc_check_ready(): SLAAC addresses and routes are not set.
Feb 09 11:30:23 slepice systemd-networkd[12922]: end2: SLAAC addresses and routes set.
</code></pre>
<h3 id="tcpdump"><a class="toclink" href="2025/02/09/2025-02-arris-pd/#tcpdump">tcpdump</a></h3>
<p>Indeed, the conclusions from the logs were right. We can see the rebind failing with T1:0 T2:0 and no prefix. Funny part is that it succeeded
several times before it failed:</p>
<pre><code>root@slepice:/home/th# tcpdump -i end2 -n ip6 and udp port 546 or udp port 547 -vvv
...
11:30:01.879154 IP6 (flowlabel 0x1639f, hlim 64, next-header UDP (17) payload length: 257) fe80::aef8:ccff:fe64:3975.547 &gt; fe80::da58:d7ff:fe00:19f3.546: [udp sum ok] dhcp6 reply (xid=452c27 (IA_NA IAID:2885014782 T1:194180 T2:310688 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:388361 vltime:388361) (status-code Success)) (IA_PD IAID:2885014782 T1:5 T2:10 (IA_PD-prefix 2a02:aa11:380:310::/60 pltime:7200 vltime:10800) (status-code Success)) (server-ID hwaddr/time type 1 time 684092944 acf8cc643975) (client-ID vid 0000ab110ccd5bd4) (preference 255) (DNS-server 2001:730:3e82::12 2001:730:3e82::13))
11:30:07.881235 IP6 (flowlabel 0x3dcd2, hlim 1, next-header UDP (17) payload length: 166) fe80::da58:d7ff:fe00:19f3.546 &gt; ff02::1:2.547: [bad udp cksum 0xc88a -&gt; 0x3c2b!] dhcp6 renew (xid=2db0ca (server-ID hwaddr/time type 1 time 684092944 acf8cc643975) (IA_NA IAID:2885014782 T1:0 T2:0 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:0 vltime:0)) (IA_PD IAID:2885014782 T1:0 T2:0 (IA_PD-prefix 2a02:aa11:380:310::/60 pltime:0 vltime:0)) (Client-FQDN) (option-request DNS-server SNTP-servers NTP-server) (client-ID vid 0000ab110ccd5bd4) (elapsed-time 0))
11:30:07.883520 IP6 (flowlabel 0x1639f, hlim 64, next-header UDP (17) payload length: 257) fe80::aef8:ccff:fe64:3975.547 &gt; fe80::da58:d7ff:fe00:19f3.546: [udp sum ok] dhcp6 reply (xid=2db0ca (IA_NA IAID:2885014782 T1:194180 T2:310688 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:388361 vltime:388361) (status-code Success)) (IA_PD IAID:2885014782 T1:5 T2:10 (IA_PD-prefix 2a02:aa11:380:310::/60 pltime:7200 vltime:10800) (status-code Success)) (server-ID hwaddr/time type 1 time 684092944 acf8cc643975) (client-ID vid 0000ab110ccd5bd4) (preference 255) (DNS-server 2001:730:3e82::12 2001:730:3e82::13))
11:30:13.653915 IP6 (flowlabel 0x3dcd2, hlim 1, next-header UDP (17) payload length: 166) fe80::da58:d7ff:fe00:19f3.546 &gt; ff02::1:2.547: [bad udp cksum 0xc88a -&gt; 0xb262!] dhcp6 renew (xid=b03a10 (server-ID hwaddr/time type 1 time 684092944 acf8cc643975) (IA_NA IAID:2885014782 T1:0 T2:0 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:0 vltime:0)) (IA_PD IAID:2885014782 T1:0 T2:0 (IA_PD-prefix 2a02:aa11:380:310::/60 pltime:0 vltime:0)) (Client-FQDN) (option-request DNS-server SNTP-servers NTP-server) (client-ID vid 0000ab110ccd5bd4) (elapsed-time 0))
11:30:13.658293 IP6 (flowlabel 0x1639f, hlim 64, next-header UDP (17) payload length: 257) fe80::aef8:ccff:fe64:3975.547 &gt; fe80::da58:d7ff:fe00:19f3.546: [udp sum ok] dhcp6 reply (xid=b03a10 (IA_NA IAID:2885014782 T1:194180 T2:310688 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:388361 vltime:388361) (status-code Success)) (IA_PD IAID:2885014782 T1:5 T2:10 (IA_PD-prefix 2a02:aa11:380:310::/60 pltime:7200 vltime:10800) (status-code Success)) (server-ID hwaddr/time type 1 time 684092944 acf8cc643975) (client-ID vid 0000ab110ccd5bd4) (preference 255) (DNS-server 2001:730:3e82::12 2001:730:3e82::13))
11:30:23.655773 IP6 (flowlabel 0x3dcd2, hlim 1, next-header UDP (17) payload length: 148) fe80::da58:d7ff:fe00:19f3.546 &gt; ff02::1:2.547: [bad udp cksum 0xc878 -&gt; 0x6651!] dhcp6 rebind (xid=92cf1e (IA_NA IAID:2885014782 T1:0 T2:0 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:0 vltime:0)) (IA_PD IAID:2885014782 T1:0 T2:0 (IA_PD-prefix 2a02:aa11:380:310::/60 pltime:0 vltime:0)) (Client-FQDN) (option-request DNS-server SNTP-servers NTP-server) (client-ID vid 0000ab110ccd5bd4) (elapsed-time 0))
11:30:23.658037 IP6 (flowlabel 0x1639f, hlim 64, next-header UDP (17) payload length: 182) fe80::aef8:ccff:fe64:3975.547 &gt; fe80::da58:d7ff:fe00:19f3.546: [udp sum ok] dhcp6 reply (xid=92cf1e (IA_NA IAID:2885014782 T1:194180 T2:310688 (IA_ADDR 2a02:aa11:380:300::d6f1 pltime:388361 vltime:388361) (status-code Success)) (IA_PD IAID:2885014782 T1:0 T2:0) (server-ID hwaddr/time type 1 time 684092944 acf8cc643975) (client-ID vid 0000ab110ccd5bd4) (preference 255) (DNS-server 2001:730:3e82::12 2001:730:3e82::13))
</code></pre>
<h3 id="whatwho-is-wrong-then"><a class="toclink" href="2025/02/09/2025-02-arris-pd/#whatwho-is-wrong-then">What/who is wrong then?</a></h3>
<p>Even though I read the relevant RFCs I am not sure where the problem really is.</p>
<ul>
<li>I believe that the modem sets insane T1:5 T2:10. WDYT @sunrise.ch ? :-)</li>
<li>I believe that the modem should stay consistent and the rebind should succeed.</li>
<li>I think that <code>systemd-networkd</code> shoud re-try to re-acquire the PD when it fails to get it. However it seems that at least with systemd 252 it is
not the case. I digged into current git master (257.3+) and I do not think that it has changed. This remains TODO to test and understand.</li>
<li>Interestingly, PD is stable with <code>wide-dhcpv6-client</code> and it seems that the router sends a bit longer T1 (like 17) as well as T2
and there are only renews and no rebinds (even after few hours running). But why? RFC says that DHCPv6 server must disregard any T1 nd T2 values
in the requests and that the client should set them to 0, which is what both <code>systemd-networkd</code> and <code>wide-dhcpv6-client</code> do.</li>
</ul>
<p>Long story short: I feel so lonely. Sunrise must have shipped thousands maybe even tens of thousands of those modems. Am I the first one who tried this?</p>
<p>TBH I do not know if the T1 and T2 values are pushed to the modem from the DOCSIS network config or if there is an upper level DHCPv6 PD or where
the decission about the T1 and T2 values actually takes place. So could it be just a small misconfigured partition of the access network?</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-05-09 13:00:00+02:00">May 9, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="maas-regiond-ignores-new-nics-what-now"><a class="toclink" href="2024/05/09/2024-21-maas-region-ignores-nics/">MAAS regiond ignores new NICs, what now?</a></h2>
<h3 id="long-story-short"><a class="toclink" href="2024/05/09/2024-21-maas-region-ignores-nics/#long-story-short">Long story short</a></h3>
<p>I have an old MAAS <code>regiond+rackd</code> (the whole thing) installed from <code>snap</code> and updated over time to the fairly recent <code>stable/3.4</code> channel that now corresponds to the version <code>3.4.2</code>.</p>
<p>I noticed that new NICs added to the VM, which runs the MAAS, never appear in the MAAS controllers -&gt; Interfaces page. But I need it in order to connect MAAS to the new VLANs we just deployed.</p>
<p>First clue comes from logs. The <code>/var/snap/maas/common/log/rackd.log</code> contains these errors:</p>
<pre><code>2024-05-09 12:00:14 twisted.internet.defer: [critical] Unhandled error in Deferred:
2024-05-09 12:00:14 twisted.internet.defer: [critical] 
    Traceback (most recent call last):
    Failure: twisted.internet.error.MulticastJoinError: (b'\xe0\x00\x00v', b'\n\x0c\n\xf8', 98, 'Address already in use')

2024-05-09 12:00:14 twisted.internet.defer: [critical] Unhandled error in Deferred:
2024-05-09 12:00:14 twisted.internet.defer: [critical] 
    Traceback (most recent call last):
    Failure: twisted.internet.error.MulticastJoinError: (b'\xe0\x00\x00v', b'\n\x0c\x07\xf8', 98, 'Address already in use')

2024-05-09 12:00:14 twisted.internet.defer: [critical] Unhandled error in Deferred:
2024-05-09 12:00:14 twisted.internet.defer: [critical] 
    Traceback (most recent call last):
    Failure: twisted.internet.error.MulticastJoinError: (b'\xe0\x00\x00v', b'\n\x0c\x13\xfa', 98, 'Address already in use')

2024-05-09 12:00:14 provisioningserver.rpc.clusterservice: [info] Rack controller 'rsryyc' registered (via sf-maasregion-1:pid=2275) with MAAS version 3.4.2-14353-g.5a5221d57.
2024-05-09 12:00:14 provisioningserver.rpc.clusterservice: [info] Rack controller 'rsryyc' registered (via sf-maasregion-1:pid=2275) with MAAS version 3.4.2-14353-g.5a5221d57.
2024-05-09 12:00:14 provisioningserver.rpc.clusterservice: [info] Rack controller 'rsryyc' registered (via sf-maasregion-1:pid=2275) with MAAS version 3.4.2-14353-g.5a5221d57.
2024-05-09 12:00:20 provisioningserver.utils.services: [warn] Couldn't report test results: HTTP error [500]
</code></pre>
<p>Even though there are multiple open bug reports that deal with the <code>twisted.internet.error.MulticastJoinError</code> I believe it is not the source of the issues here.</p>
<p>The true problem is the line <code>Couldn't report test results: HTTP error [500]</code>.</p>
<p>The complementary part on regiond from <code>/var/snap/maas/common/log/regiond.log</code>:</p>
<pre><code>2024-05-09 12:01:20 maasserver: [error] ################################ Exception: Status for scriptresult 5462 is not running or pending (2) ################################
2024-05-09 12:01:20 maasserver: [error] Traceback (most recent call last):
  File &quot;/snap/maas/35359/usr/lib/python3/dist-packages/django/core/handlers/base.py&quot;, line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/maasserver/utils/views.py&quot;, line 298, in view_atomic_with_post_commit_savepoint
    return view_atomic(*args, **kwargs)
  File &quot;/usr/lib/python3.10/contextlib.py&quot;, line 79, in inner
    return func(*args, **kwds)
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/maasserver/api/support.py&quot;, line 62, in __call__
    response = super().__call__(request, *args, **kwargs)
  File &quot;/snap/maas/35359/usr/lib/python3/dist-packages/django/views/decorators/vary.py&quot;, line 20, in inner_func
    response = func(*args, **kwargs)
  File &quot;/snap/maas/35359/usr/lib/python3.10/dist-packages/piston3/resource.py&quot;, line 197, in __call__
    result = self.error_handler(e, request, meth, em_format)
  File &quot;/snap/maas/35359/usr/lib/python3.10/dist-packages/piston3/resource.py&quot;, line 195, in __call__
    result = meth(request, *args, **kwargs)
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/maasserver/api/support.py&quot;, line 371, in dispatch
    return function(self, request, *args, **kwargs)
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/metadataserver/api.py&quot;, line 858, in signal
    target_status = process(node, request, status)
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/metadataserver/api.py&quot;, line 680, in _process_commissioning
    self._store_results(
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/metadataserver/api.py&quot;, line 563, in _store_results
    script_result.store_result(
  File &quot;/snap/maas/35359/lib/python3.10/site-packages/maasserver/models/scriptresult.py&quot;, line 270, in store_result
    self.status in SCRIPT_STATUS_RUNNING_OR_PENDING
AssertionError: Status for scriptresult 5462 is not running or pending (2)
</code></pre>
<h3 id="fix"><a class="toclink" href="2024/05/09/2024-21-maas-region-ignores-nics/#fix">Fix</a></h3>
<p>I tracked the error to <a href="https://github.com/canonical/maas/blob/cb2b108305c2dbd217853e8c5476c30f56d22081/src/maasserver/models/scriptresult.py#L269">this line</a>. But this <code>assert</code> should have never been reached because it is in the block started by:</p>
<pre><code>    if self.script_set.node.is_commissioning():
</code></pre>
<p>So the <code>status</code> of the Node object in DB for the rackd has wrong status. And indeed:</p>
<pre><code>$ sudo snap run --shell maas -c 'maas-region shell'
&gt;&gt;&gt; from maasserver.models import *
&gt;&gt;&gt; Node.objects.get(hostname=&quot;sf-maasregion-1&quot;).status
&gt;&gt;&gt; 0
</code></pre>
<p><code>0 =</code> New, so I am setting <code>6</code> for Deployed.</p>
<pre><code>&gt;&gt;&gt; n=Node.objects.get(hostname=&quot;sf-maasregion-1&quot;)
&gt;&gt;&gt; n.status = 6
&gt;&gt;&gt; n.save()
Ctrl-D

$ sudo systemctl restart snap.maas.supervisor.service
</code></pre>
<p>And that did the trick.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-03-20 22:12:00+01:00">March 20, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="migrating-blog-from-bloggercom-to-mkdocs-and-github-pages"><a class="toclink" href="2024/03/20/2024-20-blog-migration/">Migrating blog from blogger.com to mkdocs and GitHub pages</a></h2>
<h3 id="why"><a class="toclink" href="2024/03/20/2024-20-blog-migration/#why">Why?</a></h3>
<p>Simple. The management web interface was a bit painful in the beginning and it is even more so in 2024. It was simply time to move to something like Git, static page generator and CI/CD for deployment.</p>
<h3 id="how"><a class="toclink" href="2024/03/20/2024-20-blog-migration/#how">How</a></h3>
<p>I found this great blogpost <a href="https://daniel.feldroy.com/posts/2022-02-blogger-to-markdown-script">Daniel Roy Greenfeld - Blogger to Markdown Script</a> . By using the script and the described method it was easy to convert old posts from blogger.com to MD. Though the images need manual download and linking to the primary source. Or I may try to find the originals to see if they are better quality. But this remains TODO for now.</p>
<p>Then I just created quick GitHub actions to deploy the blog based on this article <a href="https://squidfunk.github.io/mkdocs-material/publishing-your-site/">Material for MkDocs - Publishing your site</a>.</p>
<p>The only downside is that the web URL is bound to be <code>&lt;username&gt;.github.io/&lt;reponame&gt;</code> but I guess it is a sensible simplification.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2023-10-04 21:21:00.003000+02:00">October 4, 2023</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="fortigate-pbr-needs-active-route-really"><a class="toclink" href="2023/10/04/2023-10-fortigate-pbr-needs-active-route-really/">FortiGate PBR needs active route - really?</a></h2>
<p><em>This was originally posted on blogger <a href="https://snarkybrill.blogspot.com/2023/10/fortigate-pbr-needs-active-route-really.html">here</a></em>.</p>
<p>Imagine you have a classic IPsec tunnel between HQ and branch with a slight twist: Say you want to distribute some portion of the address space that is assigned to HQ over the tunnel to the branch and use the IPs in branch DMZ.</p>
<p>The picture shows the routes - HQ has 5.6.7.8 address on wan1 and there are two static routes from the ISP:</p>
<ul>
<li>5.6.9.0/24 via 5.6.7.8 (use in HQ LAN)</li>
<li>5.6.10.0/24 via 5.6.7.8 (use in branch DMZ)</li>
</ul>
<p><img alt="FortiGate PBR Diagram" src="images/fortigate-pbr.png" /></p>
<p>So we set up a VPN tunnel, set static routes on HQ side, set IPs and then we need PBR to make sure that despite the default route going over wan1 on branch side to the ISP, the traffic from 5.6.10.0/24 to anywhere is routed over the tunnel back to HQ. Why? Well, the branch ISP applies RPF. Everybody is supposed to apply RPF, because it is the best practice... or something (*). (<a href="https://www.rfc-editor.org/info/bcp38">https://www.rfc-editor.org/info/bcp38</a>)</p>
<p>Anyway, the problem is that PBR on its own is apparently not enough. If you just set it up, it does not work. Since it has not been immediately apparent why to be I tried to google questions like "FortiGate PBR not working" and I eventually found one "solution" but no real answer what is going on here. To me specific, last comment <a href="https://community.fortinet.com/t5/Support-Forum/Policy-Based-Routing-PBR-not-being-applied/td-p/35673?m=166935">here</a> gives instructions that seems to work:</p>
<p>Add a new default route to routing table. The route needs to have same Administrative Distance as the active default route (towards ISP), next-hop is not needed, but the interface is vpn0 and the Priority has to be lower (= higher number) than the real active default route towards the ISP.</p>
<p>OK, it works, but why? The official <a href="https://docs.fortinet.com/document/fortigate/6.4.2/administration-guide/144044/policy-routes">manual</a> nor <a href="https://community.fortinet.com/t5/FortiGate/Technical-Tip-Configure-policy-routes-for-route-based-interface/ta-p/193376">this</a> is not really helpful and I found few other speculations on Reddit, Stack Overflow and random blogs, but nothing on the sport. So, the answer is...</p>
<p>RPF.</p>
<p>There is reverse path filtering on the tunnel interface and FortiGates use "feasible path" RPF rule by default, which means that with an active default route through the tunnel is enough to provide feasible path, even though the route is de-prioritized (to avoid causing random load-balancing that would very likely lead to random asymmetric routing and therefore random packetloss in this setting). Btw. the AD has to be same as the real static route, otherwise it will not be considered as a feasible path.</p>
<p>And another possibility is disabling the RPF with "src-check disable", like this:</p>
<pre><code>branch # config system interface

branch (interface) # edit vpn0

branch (vpn0) # show
config system interface
    edit &quot;vpn0&quot;
        set vdom &quot;root&quot;
        set allowaccess ping
        set type tunnel
        set src-check disable
        set snmp-index 19
        config ipv6
            set ip6-allowaccess ping
        end
        set interface &quot;wan&quot;
    next
end
</code></pre>
<p>(*) On more serious note - mocking BCP 38 is not fair. It is undoubtedly the best community-based and therefore Internet-native solution to great portion of the known cyber-attacks.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-03-17 23:13:00.006000+01:00">March 17, 2022</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ssh-is-going-ape-due-to-ed25519-host-keys"><a class="toclink" href="2022/03/17/2022-03-ssh-is-going-ape-due-to-ed25519-host/">SSH is going ape due to ed25519 host keys</a></h2>
<p><em>This was originally posted on blogger <a href="https://snarkybrill.blogspot.com/2022/03/ssh-is-going-ape-due-to-ed25519-host.html">here</a></em>.</p>
<p>I started seeing the complaints from SSH clients about the unknown host keys from various servers that are perfectly stable and secure few months ago. I didn't have time to fully analyze it but I suspected that it is partially caused by me running cutting-edge Debain Unstable and/or Ubuntu 22.04 (before the release).</p>
<p>The low-level cause is that "something" has changed (and as I said, I am not exactly sure what is going on here) that caused that the servers or clients prefer new <strong><em>ssh-ed25519</em></strong> instead of the old <strong><em>ecdsa-sha2-nistp256</em></strong>. Which is a good thing, only that the client keeps saying something like this:</p>
<pre><code>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the RSA key sent by the remote host is
.
Please contact your system administrator.
Add correct host key in /.ssh/known_hosts to get rid of this message.
Offending RSA key in /.ssh/known_hosts:
  remove with:
  ssh-keygen -f &quot;/.ssh/known_hosts&quot; -R &quot;&quot;
RSA host key for  has changed and you have requested strict checking.
Host key verification failed.
</code></pre>
<p>Which is a serious warning that should not be ignored in any case, unless one positively knows that the server had good reason for changing the key.</p>
<p>If you read it and started worrying, that's good. Bad thing is that after an half an hour googling and browsing <em>openssh</em> changelogs I haven't got to any a detailed explanation and/or diffs that causes that. I have two suspects:</p>
<ul>
<li>server side change (see <a href="http://metadata.ftp-master.debian.org/changelogs/main/o/openssh/unstable_changelog">http://metadata.ftp-master.debian.org/changelogs/main/o/openssh/unstable_changelog</a>)</li>
</ul>
<pre><code>New upstream release
(https://www.openssh.com/releasenotes.html#8.5p1):
    - ssh(1), sshd(8): change the first-preference signature algorithm from
      ECDSA to ED25519.
</code></pre>
<ul>
<li>client side change <a href="https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.4">https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.4</a>, that fixes this bug <a href="https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/1952421">https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/1952421</a></li>
</ul>
<p>Or maybe I am wrong. Please provide more details in discussions if you know what changes causes this change in behavior. In any case it is wrong because flashing tons of these unknown key warnings is going to make everyone used to the fact that this happening on its own. Ultimately people are going to be less vigilant and prone to MitM attacks in the end. :-(</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2021-12-09 02:32:00.002000+01:00">December 9, 2021</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="proxmox-70-catch-ceph-osd-destroy-no-disks-unused"><a class="toclink" href="2021/12/09/2021-12-proxmox-70-catch-ceph-osd-destroy-no/">ProxMox 7.0 catch - Ceph OSD destroy: No Disks unused</a></h2>
<p><em>This was originally posted on blogger <a href="https://snarkybrill.blogspot.com/2021/12/proxmox-70-catch-ceph-osd-destroy-no.html">here</a></em>.</p>
<h3 id="proxmox-osd-create-no-disks-unused"><a class="toclink" href="2021/12/09/2021-12-proxmox-70-catch-ceph-osd-destroy-no/#proxmox-osd-create-no-disks-unused">ProxMox OSD create: No Disks unused</a></h3>
<p>I just realized that when I destroy Ceph OSD in ProxMox 7.0-11 - either in Web UI or using console</p>
<pre><code># pveceph osd destroy X --cleanup 1
</code></pre>
<p>I can't create new OSD on the same disk. ProxMox simply says that there are "No Disks unused" in the Web UI OSD create form. And in console I get:</p>
<pre><code># pveceph osd create /dev/sdX
device '/dev/sdX' is already in use
</code></pre>
<p>Zaping disk with the customary</p>
<pre><code># ceph-volume lvm zap /dev/sdX --destroy
</code></pre>
<p>does not help, even though it is often very useful command.</p>
<h3 id="workaround"><a class="toclink" href="2021/12/09/2021-12-proxmox-70-catch-ceph-osd-destroy-no/#workaround">Workaround</a></h3>
<p>First I realized that rebooting the machine helps. But... Rebooting hyperconverged hypervisor to see the perfectly working disk drive in self-healing unbreakable unstoppable storage? In 2021? Seriously???</p>
<p>I realized that a bucnch of crazy Perl libraries that do everything in ProxMox call this command:</p>
<pre><code># lsblk --json -o path,parttype,fstype
{
   &quot;blockdevices&quot;: [
...
      {&quot;path&quot;:&quot;/dev/sdX&quot;, &quot;parttype&quot;:null, &quot;fstype&quot;:&quot;LVM2_member&quot;},
...
</code></pre>
<p>and they consider everything with <em>fstype</em> other than <em>null</em> to be <strong>"used"</strong>. The solution is to create any partition table on the /dev/sdX. For example just running</p>
<pre><code># fdisk /dev/sdX
</code></pre>
<p>and pressing "<strong>w</strong>" to save empty table is enough for the disk to re-appear.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-01-30 09:06:00.001000+01:00">January 30, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="java-disabled-certain-tlsssl-algorithms-enable-them-back"><a class="toclink" href="2019/01/30/2019-01-java-disabled-certain-tlsssl-algorithms/">Java disabled certain TLS/SSL algorithms - enable them back</a></h2>
<p><em>This was originally posted on blogger <a href="https://snarkybrill.blogspot.com/2019/01/java-disabled-certain-tlsssl-algorithms.html">here</a></em>.</p>
<p>Now hear this.. You know it yourself: You have a server. Not a really old one, just a bit old. It has IPMI/ILO or whatever they call the Java remote console. And it stopped working (you can run the Java client app, but it fails to connect) with the modern Ubuntu installs as a client. What the ****, you say... Well, the problem is:</p>
<pre><code>01/30/2019 08:38:17:859:  Connection failed with exception:
No appropriate protocol (protocol is disabled or cipher
suites are inappropriate)
</code></pre>
<p>The solution?: Comment out the algorithm disabling line in /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/security/java.security</p>
<pre><code>#jdk.tls.disabledAlgorithms=SSLv3, RC4, DES, MD5withRSA, \
#DH keySize &lt; 1024, EC keySize &lt; 224, 3DES_EDE_CBC
</code></pre>
<hr />
<h3 id="1-comments-captured-from-original-post-on-blogger"><a class="toclink" href="2019/01/30/2019-01-java-disabled-certain-tlsssl-algorithms/#1-comments-captured-from-original-post-on-blogger">1 comments captured from <a href="https://snarkybrill.blogspot.com/2019/01/java-disabled-certain-tlsssl-algorithms.html">original post</a> on Blogger</a></h3>
<p><strong>themylogin said on 2020-06-18</strong></p>
<p>It helped me, thank you very much!</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2016-05-01 01:13:00+02:00">May 1, 2016</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="running-vino-vnc-server-on-ubuntu-mate"><a class="toclink" href="2016/05/01/2016-05-running-vino-vnc-server-on-ubuntu-mate/">Running vino (VNC server) on Ubuntu Mate</a></h2>
<p><em>This was originally posted on blogger <a href="https://snarkybrill.blogspot.com/2016/05/running-vino-vnc-server-on-ubuntu-mate.html">here</a></em>.</p>
<p>Simple how-to:</p>
<ul>
<li><code>sudo apt-get install vino dconf-tools</code></li>
<li>run vino-preferences</li>
<li>enable remote access</li>
<li>disable confirmation of the access</li>
<li>run dconf-editor</li>
<li>go to org -&gt; gnome -&gt; desktop -&gt; remote-access</li>
<li>change network-interface to lo</li>
<li>uncheck require-encryption</li>
<li>clear vnc-password</li>
<li>create startup application for Vino VNC server</li>
<li>run <code>/usr/lib/vino/vino-server --sm-client-disable</code></li>
<li>logout &amp; login</li>
</ul>
<hr />
<h3 id="2-comments-captured-from-original-post-on-blogger"><a class="toclink" href="2016/05/01/2016-05-running-vino-vnc-server-on-ubuntu-mate/#2-comments-captured-from-original-post-on-blogger">2 comments captured from <a href="https://snarkybrill.blogspot.com/2016/05/running-vino-vnc-server-on-ubuntu-mate.html">original post</a> on Blogger</a></h3>
<p><strong>Mr. project hacker said on 2017-10-23</strong></p>
<p>Which ver of Mate?</p>
<p><strong>Tomas Hlavacek said on 2019-01-16</strong></p>
<p>From Trusty on...
Though lately (I am not sure when), the vino-preferences has been removed and the dconf-editor has its own package (named dconf-editor). At least on Cosmic it is like that.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2016-01-22 20:49:00+01:00">January 22, 2016</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="linux-lenovo-yoga-300-11ibr"><a class="toclink" href="2016/01/22/2016-01-linux-lenovo-yoga-300-11ibr/">Linux @ Lenovo Yoga 300-11IBR</a></h2>
<p><em>This was originally posted on blogger <a href="https://snarkybrill.blogspot.com/2016/01/linux-lenovo-yoga-300-11ibr.html">here</a></em>.</p>
<p>In the previous post I ranted about the utter ignorance, carelessness and windows-centredness of HP, which is unable to provide compatible ACPI and decided to put there some unknown I2C codec that even google or worse baidu haven't heard about when I tried to type the chip markings there. So I gave up and sold the Windows-only HP Pavilion X2 laptop to a friend who does not mind this crap OS.</p>
<p>And I have new and shining Lenovo Yoga 300-11IBR. It is slightly larger, heavier and has shorter battery life than the HP Pavilion X2 and it has standard 45W power brick while HP had nice tiny tablet charger with USB-C connector. But anyway, Lenovo runs Linux without problems... Well, at least without unbearable problems.</p>
<p>Before proceeding further there are some photos:</p>
<p><img alt="Lenovo Yoga 300 11IBR" src="images/lenovo-yoga-300-1.jpg" /></p>
<p>And insides:</p>
<p><img alt="Lenovo Yoga 300 11IBR Insides" src="images/lenovo-yoga-300-2.jpg" /></p>
<p>There is no fan (sweet) and there is even a place for thin 2.5'' disc, but special bracket and a cable is needed. (I have eMMC version with 64 GB and I am fine with that.)</p>
<p>OK, so what's the status with Linux. I tried this puppy with Ubuntu 15.10 and it worked out of box. Touchscreen, graphics, touchpad, camera, power indicator, sound, everything seems to be doing fine. But... I noticed some problems with ACPI after a while: Special keys, like volume + / - (physical), screen brightness + / - (virtual) seems not to be working or working with unpredictable delay. Software applets for manipulating volume and brightness works for me, so it is not a show stopper. And the same observation fits to ACPI events like AC adapter inserted or removed - there is huge delay, like tens of seconds or minute. And the same for LID close event. And the orientation sensor seems not to be supported - there is some ugly error in dmesg that concerns probing it. But I am using the laptop as a laptop so I do not care about the sensor much.</p>
<p>But anyway, the ACPI events problem might get solved in some BIOS update or there might be a solution in rewriting DSDT table. I dind't have enough time to dig deeper so far.</p>
<p>I am attaching dmesg and dmidecode outputs here.</p>
<h3 id="dmesg"><a class="toclink" href="2016/01/22/2016-01-linux-lenovo-yoga-300-11ibr/#dmesg">dmesg</a></h3>
<pre><code>[    0.000000] Initializing cgroup subsys cpuset
[    0.000000] Initializing cgroup subsys cpu
[    0.000000] Initializing cgroup subsys cpuacct
[    0.000000] Linux version 4.4.0-rc8 (brill@hroch) (gcc version 5.2.1 20151010 (Ubuntu 5.2.1-22ubuntu2) ) #1 SMP Tue Jan 5 17:25:05 CET 2016
[    0.000000] Command line: BOOT_IMAGE=/@/boot/vmlinuz-4.4.0-rc8 root=UUID=051eb2d7-2358-402b-a87c-8d7067c37512 ro rootflags=subvol=@
[    0.000000] KERNEL supported cpus:
[    0.000000]   Intel GenuineIntel
[    0.000000]   AMD AuthenticAMD
[    0.000000]   Centaur CentaurHauls
[    0.000000] x86/fpu: Legacy x87 FPU detected.
[    0.000000] x86/fpu: Using 'lazy' FPU context switches.
[    0.000000] e820: BIOS-provided physical RAM map:
[    0.000000] BIOS-e820: [mem 0x0000000000000000-0x000000000006efff] usable
[    0.000000] BIOS-e820: [mem 0x000000000006f000-0x000000000006ffff] ACPI NVS
[    0.000000] BIOS-e820: [mem 0x0000000000070000-0x0000000000085fff] usable
[    0.000000] BIOS-e820: [mem 0x0000000000086000-0x000000000009ffff] reserved
[    0.000000] BIOS-e820: [mem 0x0000000000100000-0x000000001fffffff] usable
[    0.000000] BIOS-e820: [mem 0x0000000020000000-0x00000000201fffff] reserved
[    0.000000] BIOS-e820: [mem 0x0000000020200000-0x0000000079b23fff] usable
[    0.000000] BIOS-e820: [mem 0x0000000079b24000-0x0000000079d23fff] type 20
[    0.000000] BIOS-e820: [mem 0x0000000079d24000-0x000000007a523fff] reserved
[    0.000000] BIOS-e820: [mem 0x000000007a524000-0x000000007a723fff] ACPI NVS
[    0.000000] BIOS-e820: [mem 0x000000007a724000-0x000000007a763fff] ACPI data
[    0.000000] BIOS-e820: [mem 0x000000007a764000-0x000000007b374fff] usable
[    0.000000] BIOS-e820: [mem 0x000000007b375000-0x000000007bd74fff] reserved
[    0.000000] BIOS-e820: [mem 0x000000007bd75000-0x000000007bffffff] usable
[    0.000000] BIOS-e820: [mem 0x00000000e00f8000-0x00000000e00f8fff] reserved
[    0.000000] BIOS-e820: [mem 0x00000000fed01000-0x00000000fed01fff] reserved
[    0.000000] BIOS-e820: [mem 0x00000000ffc00000-0x00000000ffffffff] reserved
[    0.000000] NX (Execute Disable) protection: active
[    0.000000] efi: EFI v2.40 by INSYDE Corp.
[    0.000000] efi:  ACPI 2.0=0x7a763014  SMBIOS=0x79eb3000  ESRT=0x79eb7618 
[    0.000000] esrt: Reserving ESRT space from 0x0000000079eb7618 to 0x0000000079eb7650.
[    0.000000] SMBIOS 2.8 present.
[    0.000000] DMI: LENOVO 80M1/Mini, BIOS C7CN24WW 08/11/2015
[    0.000000] e820: update [mem 0x00000000-0x00000fff] usable ==&amp;gt; reserved
[    0.000000] e820: remove [mem 0x000a0000-0x000fffff] usable
[    0.000000] e820: last_pfn = 0x7c000 max_arch_pfn = 0x400000000
[    0.000000] MTRR default type: uncachable
[    0.000000] MTRR fixed ranges enabled:
[    0.000000]   00000-9FFFF write-back
[    0.000000]   A0000-FFFFF write-protect
[    0.000000] MTRR variable ranges enabled:
[    0.000000]   0 base 0FFC00000 mask FFFC00000 write-protect
[    0.000000]   1 base 000000000 mask F80000000 write-back
[    0.000000]   2 base 07C000000 mask FFC000000 uncachable
[    0.000000]   3 disabled
[    0.000000]   4 disabled
[    0.000000]   5 disabled
[    0.000000]   6 disabled
[    0.000000]   7 disabled
[    0.000000] x86/PAT: Configuration [0-7]: WB  WC  UC- UC  WB  WC  UC- WT  
[    0.000000] Scanning 1 areas for low memory corruption
[    0.000000] Base memory trampoline at [ffff88000007c000] 7c000 size 24576
[    0.000000] BRK [0x031f9000, 0x031f9fff] PGTABLE
[    0.000000] BRK [0x031fa000, 0x031fafff] PGTABLE
[    0.000000] BRK [0x031fb000, 0x031fbfff] PGTABLE
[    0.000000] BRK [0x031fc000, 0x031fcfff] PGTABLE
[    0.000000] BRK [0x031fd000, 0x031fdfff] PGTABLE
[    0.000000] BRK [0x031fe000, 0x031fefff] PGTABLE
[    0.000000] RAMDISK: [mem 0x33f7a000-0x35fb4fff]
[    0.000000] ACPI: Early table checksum verification disabled
[    0.000000] ACPI: RSDP 0x000000007A763014 000024 (v02 LENOVO)
[    0.000000] ACPI: XSDT 0x000000007A763120 0000AC (v01 LENOVO CB-01    00000003      01000013)
[    0.000000] ACPI: FACP 0x000000007A75D000 00010C (v05 LENOVO CB-01    00000003 ACPI 00040000)
[    0.000000] ACPI: DSDT 0x000000007A74B000 00DC1E (v02 LENOVO CB-01    00000003 ACPI 00040000)
[    0.000000] ACPI: FACS 0x000000007A710000 000040
[    0.000000] ACPI: UEFI 0x000000007A762000 000236 (v01 LENOVO CB-01    00000001 ACPI 00040000)
[    0.000000] ACPI: TCPA 0x000000007A760000 000032 (v02 LENOVO CB-01    00000000 ACPI 00040000)
[    0.000000] ACPI: MSDM 0x000000007A75F000 000055 (v03 LENOVO CB-01    00000001 ACPI 00040000)
[    0.000000] ACPI: UEFI 0x000000007A75E000 000042 (v01 LENOVO CB-01    00000000 ACPI 00040000)
[    0.000000] ACPI: APIC 0x000000007A75C000 000084 (v03 LENOVO CB-01    00000003 ACPI 00040000)
[    0.000000] ACPI: MCFG 0x000000007A75B000 00003C (v01 LENOVO CB-01    00000003 ACPI 00040000)
[    0.000000] ACPI: SSDT 0x000000007A75A000 0005F3 (v01 INSYDE CpuDptf  00000003 ACPI 00040000)
[    0.000000] ACPI: SSDT 0x000000007A759000 00071A (v01 INSYDE DptfTab  00000003 ACPI 00040000)
[    0.000000] ACPI: SSDT 0x000000007A74A000 000763 (v01 INSYDE CpuPm    00003000 ACPI 00040000)
[    0.000000] ACPI: SSDT 0x000000007A749000 000290 (v01 INSYDE Cpu0Tst  00003000 ACPI 00040000)
[    0.000000] ACPI: SSDT 0x000000007A748000 00017A (v01 INSYDE ApTst    00003000 ACPI 00040000)
[    0.000000] ACPI: SSDT 0x000000007A747000 000432 (v01 INSYDE Tpm2Tabl 00001000 ACPI 00040000)
[    0.000000] ACPI: TPM2 0x000000007A746000 000034 (v03 LENOVO CB-01    00000000 ACPI 00040000)
[    0.000000] ACPI: SLIC 0x000000007A761000 000176 (v01 LENOVO CB-01    00000001 ACPI 00040000)
[    0.000000] ACPI: FPDT 0x000000007A745000 000044 (v01 LENOVO CB-01    00000002 ACPI 00040000)
[    0.000000] ACPI: BGRT 0x000000007A744000 000038 (v01 LENOVO CB-01    00000001 ACPI 00040000)
[    0.000000] ACPI: Local APIC address 0xfee00000
[    0.000000] No NUMA configuration found
[    0.000000] Faking a node at [mem 0x0000000000000000-0x000000007bffffff]
[    0.000000] NODE_DATA(0) allocated [mem 0x7978a000-0x7978dfff]
[    0.000000] Zone ranges:
[    0.000000]   DMA      [mem 0x0000000000001000-0x0000000000ffffff]
[    0.000000]   DMA32    [mem 0x0000000001000000-0x000000007bffffff]
[    0.000000]   Normal   empty
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x0000000000001000-0x000000000006efff]
[    0.000000]   node   0: [mem 0x0000000000070000-0x0000000000085fff]
[    0.000000]   node   0: [mem 0x0000000000100000-0x000000001fffffff]
[    0.000000]   node   0: [mem 0x0000000020200000-0x0000000079b23fff]
[    0.000000]   node   0: [mem 0x000000007a764000-0x000000007b374fff]
[    0.000000]   node   0: [mem 0x000000007bd75000-0x000000007bffffff]
[    0.000000] Initmem setup node 0 [mem 0x0000000000001000-0x000000007bffffff]
[    0.000000] On node 0 totalpages: 501572
[    0.000000]   DMA zone: 64 pages used for memmap
[    0.000000]   DMA zone: 22 pages reserved
[    0.000000]   DMA zone: 3972 pages, LIFO batch:0
[    0.000000]   DMA32 zone: 7872 pages used for memmap
[    0.000000]   DMA32 zone: 497600 pages, LIFO batch:31
[    0.000000] Reserving Intel graphics stolen memory at 0x7ce00000-0x7edfffff
[    0.000000] ACPI: PM-Timer IO Port: 0x408
[    0.000000] ACPI: Local APIC address 0xfee00000
[    0.000000] ACPI: LAPIC_NMI (acpi_id[0x01] high level lint[0x1])
[    0.000000] ACPI: LAPIC_NMI (acpi_id[0x02] high level lint[0x1])
[    0.000000] ACPI: LAPIC_NMI (acpi_id[0x03] high level lint[0x1])
[    0.000000] ACPI: LAPIC_NMI (acpi_id[0x04] high level lint[0x1])
[    0.000000] IOAPIC[0]: apic_id 1, version 32, address 0xfec00000, GSI 0-114
[    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)
[    0.000000] ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 high level)
[    0.000000] ACPI: IRQ0 used by override.
[    0.000000] ACPI: IRQ9 used by override.
[    0.000000] Using ACPI (MADT) for SMP configuration information
[    0.000000] smpboot: Allowing 4 CPUs, 0 hotplug CPUs
[    0.000000] PM: Registered nosave memory: [mem 0x00000000-0x00000fff]
[    0.000000] PM: Registered nosave memory: [mem 0x0006f000-0x0006ffff]
[    0.000000] PM: Registered nosave memory: [mem 0x00086000-0x0009ffff]
[    0.000000] PM: Registered nosave memory: [mem 0x000a0000-0x000fffff]
[    0.000000] PM: Registered nosave memory: [mem 0x20000000-0x201fffff]
[    0.000000] PM: Registered nosave memory: [mem 0x79b24000-0x79d23fff]
[    0.000000] PM: Registered nosave memory: [mem 0x79d24000-0x7a523fff]
[    0.000000] PM: Registered nosave memory: [mem 0x7a524000-0x7a723fff]
[    0.000000] PM: Registered nosave memory: [mem 0x7a724000-0x7a763fff]
[    0.000000] PM: Registered nosave memory: [mem 0x7b375000-0x7bd74fff]
[    0.000000] e820: [mem 0x7ee00000-0xe00f7fff] available for PCI devices
[    0.000000] Booting paravirtualized kernel on bare hardware
[    0.000000] clocksource: refined-jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 7645519600211568 ns
[    0.000000] setup_percpu: NR_CPUS:256 nr_cpumask_bits:256 nr_cpu_ids:4 nr_node_ids:1
[    0.000000] PERCPU: Embedded 33 pages/cpu @ffff880079400000 s97496 r8192 d29480 u524288
[    0.000000] pcpu-alloc: s97496 r8192 d29480 u524288 alloc=1*2097152
[    0.000000] pcpu-alloc: [0] 0 1 2 3 
[    0.000000] Built 1 zonelists in Node order, mobility grouping on.  Total pages: 493614
[    0.000000] Policy zone: DMA32
[    0.000000] Kernel command line: BOOT_IMAGE=/@/boot/vmlinuz-4.4.0-rc8 root=UUID=051eb2d7-2358-402b-a87c-8d7067c37512 ro rootflags=subvol=@
[    0.000000] PID hash table entries: 4096 (order: 3, 32768 bytes)
[    0.000000] Calgary: detecting Calgary via BIOS EBDA area
[    0.000000] Calgary: Unable to locate Rio Grande table in EBDA - bailing!
[    0.000000] Memory: 1887208K/2006288K available (8299K kernel code, 1269K rwdata, 3980K rodata, 1464K init, 1292K bss, 119080K reserved, 0K cma-reserved)
[    0.000000] SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=4, Nodes=1
[    0.000000] Hierarchical RCU implementation.
[    0.000000]  Build-time adjustment of leaf fanout to 64.
[    0.000000]  RCU restricting CPUs from NR_CPUS=256 to nr_cpu_ids=4.
[    0.000000] RCU: Adjusting geometry for rcu_fanout_leaf=64, nr_cpu_ids=4
[    0.000000] NR_IRQS:16640 nr_irqs:1024 16
[    0.000000] Console: colour dummy device 80x25
[    0.000000] console [tty0] enabled
[    0.000000] tsc: PIT calibration matches PMTIMER. 1 loops
[    0.000000] tsc: Detected 1600.004 MHz processor
[    0.000056] Calibrating delay loop (skipped), value calculated using timer frequency.. 3200.00 BogoMIPS (lpj=6400016)
[    0.000076] pid_max: default: 32768 minimum: 301
[    0.000099] ACPI: Core revision 20150930
[    0.046892] ACPI: 7 ACPI AML tables successfully acquired and loaded
[    0.048640] Security Framework initialized
[    0.048660] Yama: becoming mindful.
[    0.048686] AppArmor: AppArmor initialized
[    0.049041] Dentry cache hash table entries: 262144 (order: 9, 2097152 bytes)
[    0.050259] Inode-cache hash table entries: 131072 (order: 8, 1048576 bytes)
[    0.050820] Mount-cache hash table entries: 4096 (order: 3, 32768 bytes)
[    0.050843] Mountpoint-cache hash table entries: 4096 (order: 3, 32768 bytes)
[    0.051299] Initializing cgroup subsys io
[    0.051320] Initializing cgroup subsys memory
[    0.051343] Initializing cgroup subsys devices
[    0.051357] Initializing cgroup subsys freezer
[    0.051369] Initializing cgroup subsys net_cls
[    0.051380] Initializing cgroup subsys perf_event
[    0.051394] Initializing cgroup subsys net_prio
[    0.051407] Initializing cgroup subsys hugetlb
[    0.051423] Initializing cgroup subsys pids
[    0.051461] CPU: Physical Processor ID: 0
[    0.051470] CPU: Processor Core ID: 0
[    0.051483] ENERGY_PERF_BIAS: Set to 'normal', was 'performance'
[    0.051492] ENERGY_PERF_BIAS: View and update with x86_energy_perf_policy(8)
[    0.056946] mce: CPU supports 6 MCE banks
[    0.056968] CPU0: Thermal monitoring enabled (TM1)
[    0.056980] process: using mwait in idle threads
[    0.056992] Last level iTLB entries: 4KB 48, 2MB 0, 4MB 0
[    0.057002] Last level dTLB entries: 4KB 256, 2MB 16, 4MB 16, 1GB 0
[    0.057494] Freeing SMP alternatives memory: 28K (ffffffff820ad000 - ffffffff820b4000)
[    0.065291] ftrace: allocating 31468 entries in 123 pages
[    0.090636] ..TIMER: vector=0x30 apic1=0 pin1=2 apic2=-1 pin2=-1
[    0.130372] TSC deadline timer enabled
[    0.130380] smpboot: CPU0: Intel(R) Celeron(R) CPU  N3150  @ 1.60GHz (family: 0x6, model: 0x4c, stepping: 0x3)
[    0.130466] Performance Events: PEBS fmt2+, 8-deep LBR, Silvermont events, full-width counters, Intel PMU driver.
[    0.130505] ... version:                3
[    0.130513] ... bit width:              40
[    0.130522] ... generic registers:      2
[    0.130529] ... value mask:             000000ffffffffff
[    0.130538] ... max period:             000000ffffffffff
[    0.130546] ... fixed-purpose events:   3
[    0.130553] ... event mask:             0000000700000003
[    0.132335] x86: Booting SMP configuration:
[    0.132351] .... node  #0, CPUs:      #1
[    0.140170] NMI watchdog: enabled on all CPUs, permanently consumes one hw-PMU counter.
[    0.140468]  #2 #3
[    0.155854] x86: Booted up 1 node, 4 CPUs
[    0.155871] smpboot: Total of 4 processors activated (12800.03 BogoMIPS)
[    0.156986] devtmpfs: initialized
[    0.165520] evm: security.selinux
[    0.165532] evm: security.SMACK64
[    0.165539] evm: security.SMACK64EXEC
[    0.165547] evm: security.SMACK64TRANSMUTE
[    0.165554] evm: security.SMACK64MMAP
[    0.165562] evm: security.ima
[    0.165570] evm: security.capability
[    0.165736] PM: Registering ACPI NVS region [mem 0x0006f000-0x0006ffff] (4096 bytes)
[    0.165752] PM: Registering ACPI NVS region [mem 0x7a524000-0x7a723fff] (2097152 bytes)
[    0.166015] clocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 7645041785100000 ns
[    0.166233] pinctrl core: initialized pinctrl subsystem
[    0.166531] RTC time: 18:59:18, date: 01/22/16
[    0.166892] NET: Registered protocol family 16
[    0.176593] cpuidle: using governor ladder
[    0.188601] cpuidle: using governor menu
[    0.188616] PCCT header not found.
[    0.188780] ACPI FADT declares the system doesn't support PCIe ASPM, so disable it
[    0.188797] ACPI: bus type PCI registered
[    0.188808] acpiphp: ACPI Hot Plug PCI Controller Driver version: 0.5
[    0.188992] PCI: MMCONFIG for domain 0000 [bus 00-3f] at [mem 0xe0000000-0xe3ffffff] (base 0xe0000000)
[    0.189011] PCI: not using MMCONFIG
[    0.189020] PCI: Using configuration type 1 for base access
[    0.209632] ACPI: Added _OSI(Module Device)
[    0.209646] ACPI: Added _OSI(Processor Device)
[    0.209655] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.209663] ACPI: Added _OSI(Processor Aggregator Device)
[    0.217269] [Firmware Bug]: ACPI: BIOS _OSI(Linux) query ignored
[    0.217353] ACPI Error: No handler for Region [ECRM] (ffff8800758ac1f8) [EmbeddedControl] (20150930/evregion-163)
[    0.217377] ACPI Error: Region EmbeddedControl (ID=3) has no handler (20150930/exfldio-297)
[    0.217402] ACPI Error: Method parse/execution failed [\_SB.PCI0.LPCB.H_EC._REG] (Node ffff8800758ae988), AE_NOT_EXIST (20150930/psparse-542)
[    0.233257] ACPI: Dynamic OEM Table Load:
[    0.233286] ACPI: SSDT 0xFFFF88007516D800 000613 (v01 PmRef  Cpu0Ist  00003000 INTL 20130117)
[    0.235150] ACPI: Dynamic OEM Table Load:
[    0.235171] ACPI: SSDT 0xFFFF88007535D400 000357 (v01 PmRef  Cpu0Cst  00003001 INTL 20130117)
[    0.237883] ACPI: Dynamic OEM Table Load:
[    0.237904] ACPI: SSDT 0xFFFF880075390400 00015F (v01 PmRef  ApIst    00003000 INTL 20130117)
[    0.239627] ACPI: Dynamic OEM Table Load:
[    0.239647] ACPI: SSDT 0xFFFF88007533DD80 00008D (v01 PmRef  ApCst    00003000 INTL 20130117)
[    0.244197] ACPI : EC: EC started
[    0.468046] ACPI: Interpreter enabled
[    0.468073] ACPI Exception: AE_NOT_FOUND, While evaluating Sleep State [\_S1_] (20150930/hwxface-580)
[    0.468098] ACPI Exception: AE_NOT_FOUND, While evaluating Sleep State [\_S2_] (20150930/hwxface-580)
[    0.468157] ACPI: (supports S0 S3 S4 S5)
[    0.468167] ACPI: Using IOAPIC for interrupt routing
[    0.468282] PCI: MMCONFIG for domain 0000 [bus 00-3f] at [mem 0xe0000000-0xe3ffffff] (base 0xe0000000)
[    0.472593] PCI: MMCONFIG at [mem 0xe0000000-0xe3ffffff] reserved in ACPI motherboard resources
[    0.472631] PCI: Using host bridge windows from ACPI; if necessary, use &quot;pci=nocrs&quot; and report a bug
[    0.495249] ACPI: Power Resource [USBC] (on)
[    0.507407] ACPI: Power Resource [CLK0] (on)
[    0.508623] ACPI: Power Resource [CLK0] (on)
[    0.508758] ACPI: Power Resource [CLK1] (on)
[    0.518051] ACPI: Power Resource [ID3C] (off)
[    0.527748] ACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])
[    0.527777] acpi PNP0A08:00: _OSC: OS supports [ExtendedConfig ASPM ClockPM Segments MSI]
[    0.527972] \_SB_.PCI0:_OSC invalid UUID
[    0.527977] _OSC request data:1 1f 0 
[    0.527988] acpi PNP0A08:00: _OSC failed (AE_ERROR); disabling ASPM
[    0.528035] acpi PNP0A08:00: [Firmware Info]: MMCONFIG for domain 0000 [bus 00-3f] only partially covers this bridge
[    0.529308] PCI host bridge to bus 0000:00
[    0.529326] pci_bus 0000:00: root bus resource [io  0x0070-0x0077]
[    0.529337] pci_bus 0000:00: root bus resource [io  0x0000-0x006f window]
[    0.529348] pci_bus 0000:00: root bus resource [io  0x0078-0x0cf7 window]
[    0.529359] pci_bus 0000:00: root bus resource [io  0x0d00-0xffff window]
[    0.529370] pci_bus 0000:00: root bus resource [mem 0x000a0000-0x000bffff window]
[    0.529384] pci_bus 0000:00: root bus resource [mem 0x000c0000-0x000dffff window]
[    0.529398] pci_bus 0000:00: root bus resource [mem 0x000e0000-0x000fffff window]
[    0.529413] pci_bus 0000:00: root bus resource [mem 0x80000000-0xdfffffff window]
[    0.529428] pci_bus 0000:00: root bus resource [bus 00-ff]
[    0.529451] pci 0000:00:00.0: [8086:2280] type 00 class 0x060000
[    0.529865] pci 0000:00:02.0: [8086:22b1] type 00 class 0x030000
[    0.529905] pci 0000:00:02.0: reg 0x10: [mem 0x90000000-0x90ffffff 64bit]
[    0.529922] pci 0000:00:02.0: reg 0x18: [mem 0x80000000-0x8fffffff 64bit pref]
[    0.529936] pci 0000:00:02.0: reg 0x20: [io  0x2000-0x203f]
[    0.530257] pci 0000:00:0b.0: [8086:22dc] type 00 class 0x118000
[    0.530294] pci 0000:00:0b.0: reg 0x10: [mem 0x91518000-0x91518fff 64bit]
[    0.530640] pci 0000:00:14.0: [8086:22b5] type 00 class 0x0c0330
[    0.530689] pci 0000:00:14.0: reg 0x10: [mem 0x91500000-0x9150ffff 64bit]
[    0.530785] pci 0000:00:14.0: PME# supported from D3hot D3cold
[    0.531032] pci 0000:00:14.0: System wakeup disabled by ACPI
[    0.531146] pci 0000:00:1a.0: [8086:2298] type 00 class 0x108000
[    0.531187] pci 0000:00:1a.0: reg 0x10: [mem 0x91400000-0x914fffff]
[    0.531202] pci 0000:00:1a.0: reg 0x14: [mem 0x91300000-0x913fffff]
[    0.531291] pci 0000:00:1a.0: PME# supported from D0 D3hot
[    0.531706] pci 0000:00:1b.0: [8086:2284] type 00 class 0x040300
[    0.531758] pci 0000:00:1b.0: reg 0x10: [mem 0x91510000-0x91513fff 64bit]
[    0.531864] pci 0000:00:1b.0: PME# supported from D0 D3hot D3cold
[    0.532073] pci 0000:00:1b.0: System wakeup disabled by ACPI
[    0.532179] pci 0000:00:1c.0: [8086:22c8] type 01 class 0x060400
[    0.532300] pci 0000:00:1c.0: PME# supported from D0 D3hot D3cold
[    0.532495] pci 0000:00:1c.0: System wakeup disabled by ACPI
[    0.532601] pci 0000:00:1c.1: [8086:22ca] type 01 class 0x060400
[    0.532719] pci 0000:00:1c.1: PME# supported from D0 D3hot D3cold
[    0.532912] pci 0000:00:1c.1: System wakeup disabled by ACPI
[    0.533027] pci 0000:00:1c.2: [8086:22cc] type 01 class 0x060400
[    0.533146] pci 0000:00:1c.2: PME# supported from D0 D3hot D3cold
[    0.533338] pci 0000:00:1c.2: System wakeup disabled by ACPI
[    0.533458] pci 0000:00:1f.0: [8086:229c] type 00 class 0x060100
[    0.533855] pci 0000:00:1f.3: [8086:2292] type 00 class 0x0c0500
[    0.533937] pci 0000:00:1f.3: reg 0x10: [mem 0x91519000-0x9151901f]
[    0.534057] pci 0000:00:1f.3: reg 0x20: [io  0x2040-0x205f]
[    0.534625] pci 0000:01:00.0: [1217:8621] type 00 class 0x080501
[    0.534703] pci 0000:01:00.0: reg 0x10: [mem 0x91201000-0x91201fff]
[    0.534730] pci 0000:01:00.0: reg 0x14: [mem 0x91200000-0x912007ff]
[    0.534962] pci 0000:01:00.0: PME# supported from D3hot D3cold
[    0.535065] pci 0000:01:00.0: System wakeup disabled by ACPI
[    0.541063] pci 0000:00:1c.0: PCI bridge to [bus 01]
[    0.541084] pci 0000:00:1c.0:   bridge window [mem 0x91200000-0x912fffff]
[    0.541351] pci 0000:02:00.0: [8086:08b4] type 00 class 0x028000
[    0.541569] pci 0000:02:00.0: reg 0x10: [mem 0x91100000-0x91101fff 64bit]
[    0.541861] pci 0000:02:00.0: PME# supported from D0 D3hot D3cold
[    0.541990] pci 0000:02:00.0: System wakeup disabled by ACPI
[    0.549071] pci 0000:00:1c.1: PCI bridge to [bus 02]
[    0.549089] pci 0000:00:1c.1:   bridge window [mem 0x91100000-0x911fffff]
[    0.549245] pci 0000:03:00.0: [10ec:8168] type 00 class 0x020000
[    0.549303] pci 0000:03:00.0: reg 0x10: [io  0x1000-0x10ff]
[    0.549343] pci 0000:03:00.0: reg 0x18: [mem 0x91004000-0x91004fff 64bit]
[    0.549369] pci 0000:03:00.0: reg 0x20: [mem 0x91000000-0x91003fff 64bit]
[    0.549483] pci 0000:03:00.0: supports D1 D2
[    0.549488] pci 0000:03:00.0: PME# supported from D0 D1 D2 D3hot D3cold
[    0.549592] pci 0000:03:00.0: System wakeup disabled by ACPI
[    0.557051] pci 0000:00:1c.2: PCI bridge to [bus 03]
[    0.557067] pci 0000:00:1c.2:   bridge window [io  0x1000-0x1fff]
[    0.557074] pci 0000:00:1c.2:   bridge window [mem 0x91000000-0x910fffff]
[    0.571569] ACPI: PCI Interrupt Link [LNKA] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.571871] ACPI: PCI Interrupt Link [LNKB] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.572170] ACPI: PCI Interrupt Link [LNKC] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.572464] ACPI: PCI Interrupt Link [LNKD] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.572755] ACPI: PCI Interrupt Link [LNKE] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.573059] ACPI: PCI Interrupt Link [LNKF] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.573354] ACPI: PCI Interrupt Link [LNKG] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.573648] ACPI: PCI Interrupt Link [LNKH] (IRQs 3 4 5 6 10 11 12 14 15) *0, disabled.
[    0.575965] ACPI: Enabled 5 GPEs in block 00 to 3F
[    0.576069] ACPI : EC: GPE = 0x16, I/O: command/status = 0x66, data = 0x62
[    0.576386] vgaarb: setting as boot device: PCI:0000:00:02.0
[    0.576401] vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none
[    0.576419] vgaarb: loaded
[    0.576428] vgaarb: bridge control possible 0000:00:02.0
[    0.577019] SCSI subsystem initialized
[    0.577234] libata version 3.00 loaded.
[    0.577346] ACPI: bus type USB registered
[    0.577416] usbcore: registered new interface driver usbfs
[    0.577458] usbcore: registered new interface driver hub
[    0.577522] usbcore: registered new device driver usb
[    0.578044] PCI: Using ACPI for IRQ routing
[    0.580691] PCI: pci_cache_line_size set to 64 bytes
[    0.580820] e820: reserve RAM buffer [mem 0x0006f000-0x0006ffff]
[    0.580825] e820: reserve RAM buffer [mem 0x00086000-0x0008ffff]
[    0.580828] e820: reserve RAM buffer [mem 0x79b24000-0x7bffffff]
[    0.580832] e820: reserve RAM buffer [mem 0x7b375000-0x7bffffff]
[    0.581147] NetLabel: Initializing
[    0.581159] NetLabel:  domain hash size = 128
[    0.581167] NetLabel:  protocols = UNLABELED CIPSOv4
[    0.581199] NetLabel:  unlabeled traffic allowed by default
[    0.581453] clocksource: Switched to clocksource refined-jiffies
[    0.595898] AppArmor: AppArmor Filesystem Enabled
[    0.596094] pnp: PnP ACPI init
[    0.613596] system 00:00: [io  0x0680-0x069f] has been reserved
[    0.613614] system 00:00: [io  0x0400-0x047f] has been reserved
[    0.613626] system 00:00: [io  0x0500-0x05fe] has been reserved
[    0.613647] system 00:00: Plug and Play ACPI device, IDs PNP0c02 (active)
[    0.613872] pnp 00:01: Plug and Play ACPI device, IDs PNP0303 (active)
[    0.613986] pnp 00:02: Plug and Play ACPI device, IDs SYN2b54 PNP0f13 (active)
[    0.619378] system 00:03: [mem 0x91522000-0x91522fff] has been reserved
[    0.619393] system 00:03: [mem 0x91520000-0x91520fff] has been reserved
[    0.619405] system 00:03: [mem 0x9151e000-0x9151efff] has been reserved
[    0.619417] system 00:03: [mem 0x9151c000-0x9151cfff] has been reserved
[    0.619428] system 00:03: [mem 0x9151a000-0x9151afff] has been reserved
[    0.619443] system 00:03: Plug and Play ACPI device, IDs PNP0c02 (active)
[    0.619637] system 00:04: [mem 0xe0000000-0xefffffff] could not be reserved
[    0.619651] system 00:04: [mem 0xfea00000-0xfeafffff] has been reserved
[    0.619662] system 00:04: [mem 0xfed01000-0xfed01fff] has been reserved
[    0.619675] system 00:04: [mem 0xfed03000-0xfed03fff] has been reserved
[    0.619686] system 00:04: [mem 0xfed06000-0xfed06fff] has been reserved
[    0.619697] system 00:04: [mem 0xfed08000-0xfed09fff] has been reserved
[    0.619709] system 00:04: [mem 0xfed80000-0xfedbffff] could not be reserved
[    0.619720] system 00:04: [mem 0xfed1c000-0xfed1cfff] has been reserved
[    0.619731] system 00:04: [mem 0xfee00000-0xfeefffff] has been reserved
[    0.619747] system 00:04: Plug and Play ACPI device, IDs PNP0c02 (active)
[    0.620347] pnp 00:05: Plug and Play ACPI device, IDs PNP0b00 (active)
[    0.621041] pnp: PnP ACPI: found 6 devices
[    0.630688] clocksource: acpi_pm: mask: 0xffffff max_cycles: 0xffffff, max_idle_ns: 2085701024 ns
[    0.630743] clocksource: Switched to clocksource acpi_pm
[    0.630815] pci 0000:00:1c.0: PCI bridge to [bus 01]
[    0.630834] pci 0000:00:1c.0:   bridge window [mem 0x91200000-0x912fffff]
[    0.630856] pci 0000:00:1c.1: PCI bridge to [bus 02]
[    0.630870] pci 0000:00:1c.1:   bridge window [mem 0x91100000-0x911fffff]
[    0.630890] pci 0000:00:1c.2: PCI bridge to [bus 03]
[    0.630902] pci 0000:00:1c.2:   bridge window [io  0x1000-0x1fff]
[    0.630916] pci 0000:00:1c.2:   bridge window [mem 0x91000000-0x910fffff]
[    0.630939] pci_bus 0000:00: resource 4 [io  0x0070-0x0077]
[    0.630945] pci_bus 0000:00: resource 5 [io  0x0000-0x006f window]
[    0.630949] pci_bus 0000:00: resource 6 [io  0x0078-0x0cf7 window]
[    0.630954] pci_bus 0000:00: resource 7 [io  0x0d00-0xffff window]
[    0.630959] pci_bus 0000:00: resource 8 [mem 0x000a0000-0x000bffff window]
[    0.630963] pci_bus 0000:00: resource 9 [mem 0x000c0000-0x000dffff window]
[    0.630968] pci_bus 0000:00: resource 10 [mem 0x000e0000-0x000fffff window]
[    0.630973] pci_bus 0000:00: resource 11 [mem 0x80000000-0xdfffffff window]
[    0.630978] pci_bus 0000:01: resource 1 [mem 0x91200000-0x912fffff]
[    0.630984] pci_bus 0000:02: resource 1 [mem 0x91100000-0x911fffff]
[    0.630989] pci_bus 0000:03: resource 0 [io  0x1000-0x1fff]
[    0.630994] pci_bus 0000:03: resource 1 [mem 0x91000000-0x910fffff]
[    0.631069] NET: Registered protocol family 2
[    0.631471] TCP established hash table entries: 16384 (order: 5, 131072 bytes)
[    0.631580] TCP bind hash table entries: 16384 (order: 6, 262144 bytes)
[    0.631689] TCP: Hash tables configured (established 16384 bind 16384)
[    0.631775] UDP hash table entries: 1024 (order: 3, 32768 bytes)
[    0.631812] UDP-Lite hash table entries: 1024 (order: 3, 32768 bytes)
[    0.631948] NET: Registered protocol family 1
[    0.631996] pci 0000:00:02.0: Video device with shadowed ROM
[    0.633995] PCI: CLS 64 bytes, default 64
[    0.634130] Trying to unpack rootfs image as initramfs...
[    1.772950] Freeing initrd memory: 33004K (ffff880033f7a000 - ffff880035fb5000)
[    1.773427] Scanning for low memory corruption every 60 seconds
[    1.774546] futex hash table entries: 1024 (order: 4, 65536 bytes)
[    1.774636] audit: initializing netlink subsys (disabled)
[    1.774678] audit: type=2000 audit(1453489159.771:1): initialized
[    1.775438] Initialise system trusted keyring
[    1.775822] HugeTLB registered 2 MB page size, pre-allocated 0 pages
[    1.779904] zbud: loaded
[    1.780407] VFS: Disk quotas dquot_6.6.0
[    1.780510] VFS: Dquot-cache hash table entries: 512 (order 0, 4096 bytes)
[    1.781858] fuse init (API version 7.23)
[    1.782301] Key type big_key registered
[    1.783923] Key type asymmetric registered
[    1.783940] Asymmetric key parser 'x509' registered
[    1.784061] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 249)
[    1.784195] io scheduler noop registered
[    1.784210] io scheduler deadline registered (default)
[    1.784305] io scheduler cfq registered
[    1.785416] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
[    1.785444] pciehp: PCI Express Hot Plug Controller Driver version: 0.4
[    1.785536] efifb: probing for efifb
[    1.785576] efifb: framebuffer at 0x80000000, mapped to 0xffffc90000800000, using 4160k, total 4160k
[    1.785593] efifb: mode is 1366x768x32, linelength=5504, pages=1
[    1.785601] efifb: scrolling: redraw
[    1.785610] efifb: Truecolor: size=8:8:8:8, shift=24:16:8:0
[    1.794256] Console: switching to colour frame buffer device 170x48
[    1.802569] fb0: EFI VGA frame buffer device
[    1.802647] intel_idle: MWAIT substates: 0x33000020
[    1.802651] intel_idle: v0.4 model 0x4C
[    1.802654] intel_idle: lapic_timer_reliable_states 0xffffffff
[    1.804148] ACPI: Deprecated procfs I/F for AC is loaded, please retry with CONFIG_ACPI_PROCFS_POWER cleared
[    1.804372] ACPI: AC Adapter [ADP1] (off-line)
[    1.804605] input: Lid Switch as /devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0D:00/input/input0
[    1.805411] ACPI: Lid Switch [LID0]
[    1.805569] input: Power Button as /devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0C:00/input/input1
[    1.805680] ACPI: Power Button [PWRB]
[    1.805829] input: Sleep Button as /devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0E:00/input/input2
[    1.805938] ACPI: Sleep Button [SLPB]
[    1.806088] input: Power Button as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input3
[    1.806185] ACPI: Power Button [PWRF]
[    1.812790] GHES: HEST is not enabled!
[    1.813950] Serial: 8250/16550 driver, 32 ports, IRQ sharing enabled
[    1.828041] Linux agpgart interface v0.103
[    1.837753] brd: module loaded
[    1.843052] loop: module loaded
[    1.843733] libphy: Fixed MDIO Bus: probed
[    1.843795] tun: Universal TUN/TAP device driver, 1.6
[    1.843861] tun: (C) 1999-2004 Max Krasnyansky 
[    1.844131] PPP generic driver version 2.4.2
[    1.844423] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver
[    1.844519] ehci-pci: EHCI PCI platform driver
[    1.844604] ehci-platform: EHCI generic platform driver
[    1.847586] ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver
[    1.850513] ohci-pci: OHCI PCI platform driver
[    1.853448] ohci-platform: OHCI generic platform driver
[    1.856406] uhci_hcd: USB Universal Host Controller Interface driver
[    1.859777] xhci_hcd 0000:00:14.0: xHCI Host Controller
[    1.862724] xhci_hcd 0000:00:14.0: new USB bus registered, assigned bus number 1
[    1.867016] xhci_hcd 0000:00:14.0: hcc params 0x200077c1 hci version 0x100 quirks 0x00109810
[    1.870119] xhci_hcd 0000:00:14.0: cache line size of 64 is not supported
[    1.870517] usb usb1: New USB device found, idVendor=1d6b, idProduct=0002
[    1.873515] usb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    1.876566] usb usb1: Product: xHCI Host Controller
[    1.879571] usb usb1: Manufacturer: Linux 4.4.0-rc8 xhci-hcd
[    1.882541] usb usb1: SerialNumber: 0000:00:14.0
[    1.886073] hub 1-0:1.0: USB hub found
[    1.889206] hub 1-0:1.0: 7 ports detected
[    1.894004] xhci_hcd 0000:00:14.0: xHCI Host Controller
[    1.896998] xhci_hcd 0000:00:14.0: new USB bus registered, assigned bus number 2
[    1.900209] usb usb2: New USB device found, idVendor=1d6b, idProduct=0003
[    1.903216] usb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    1.906174] usb usb2: Product: xHCI Host Controller
[    1.909132] usb usb2: Manufacturer: Linux 4.4.0-rc8 xhci-hcd
[    1.912047] usb usb2: SerialNumber: 0000:00:14.0
[    1.915371] hub 2-0:1.0: USB hub found
[    1.918192] hub 2-0:1.0: 6 ports detected
[    1.923059] i8042: PNP: PS/2 Controller [PNP0303:PS2K,PNP0f13:PS2M] at 0x60,0x64 irq 1,12
[    1.939604] serio: i8042 KBD port at 0x60,0x64 irq 1
[    1.942508] serio: i8042 AUX port at 0x60,0x64 irq 12
[    1.946476] mousedev: PS/2 mouse device common for all mice
[    1.950770] rtc_cmos 00:05: RTC can wake from S4
[    1.954060] rtc_cmos 00:05: rtc core: registered rtc_cmos as rtc0
[    1.956779] rtc_cmos 00:05: alarms up to one month, y3k, 242 bytes nvram
[    1.959423] i2c /dev entries driver
[    1.962186] device-mapper: uevent: version 1.0.3
[    1.965073] device-mapper: ioctl: 4.34.0-ioctl (2015-10-28) initialised: dm-devel@redhat.com
[    1.967690] Intel P-state driver initializing.
[    1.971220] ledtrig-cpu: registered to indicate activity on CPUs
[    1.979265] EFI Variables Facility v0.08 2004-May-17
[    2.011471] NET: Registered protocol family 10
[    2.014020] NET: Registered protocol family 17
[    2.016010] Key type dns_resolver registered
[    2.018596] microcode: CPU0 sig=0x406c3, pf=0x1, revision=0x353
[    2.020702] microcode: CPU1 sig=0x406c3, pf=0x1, revision=0x353
[    2.022618] microcode: CPU2 sig=0x406c3, pf=0x1, revision=0x353
[    2.024675] microcode: CPU3 sig=0x406c3, pf=0x1, revision=0x353
[    2.024901] input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input4
[    2.028799] microcode: Microcode Update Driver: v2.01 , Peter Oruba
[    2.031769] registered taskstats version 1
[    2.033684] Loading compiled-in X.509 certificates
[    2.037631] Loaded X.509 cert 'Build time autogenerated kernel key: a94ae5e8cd5c2afb498f40149979883cad602066'
[    2.039715] zswap: loaded using pool lzo/zbud
[    2.048029] Key type trusted registered
[    2.061997] Key type encrypted registered
[    2.064100] AppArmor: AppArmor sha1 policy hashing enabled
[    2.066124] ima: No TPM chip found, activating TPM-bypass!
[    2.068372] evm: HMAC attrs: 0x1
[    2.071940]   Magic number: 0:973:999
[    2.073943] i8042 kbd 00:01: hash matches
[    2.075927]  pnp0: hash matches
[    2.078244] rtc_cmos 00:05: setting system clock to 2016-01-22 18:59:20 UTC (1453489160)
[    2.080819] BIOS EDD facility v0.16 2004-Jun-25, 0 devices found
[    2.082860] EDD information not available.
[    2.085052] PM: Hibernation image not present or could not be loaded.
[    2.093335] ACPI: Deprecated procfs I/F for battery is loaded, please retry with CONFIG_ACPI_PROCFS_POWER cleared
[    2.095479] ACPI: Battery Slot [BAT1] (battery present)
[    2.100635] Freeing unused kernel memory: 1464K (ffffffff81f3f000 - ffffffff820ad000)
[    2.102801] Write protecting the kernel read-only data: 14336k
[    2.107543] Freeing unused kernel memory: 1928K (ffff88000281e000 - ffff880002a00000)
[    2.110945] Freeing unused kernel memory: 116K (ffff880002de3000 - ffff880002e00000)
[    2.158455] random: systemd-udevd urandom read with 12 bits of entropy available
[    2.214744] usb 1-5: new high-speed USB device number 2 using xhci_hcd
[    2.257726] FUJITSU Extended Socket Network Device Driver - version 1.0 - Copyright (c) 2015 FUJITSU LIMITED
[    2.260479] sdhci: Secure Digital Host Controller Interface driver
[    2.262860] sdhci: Copyright(c) Pierre Ossman
[    2.268996] sdhci-acpi 80860F14:00: No vmmc regulator found
[    2.271313] sdhci-acpi 80860F14:00: No vqmmc regulator found
[    2.273754] hidraw: raw HID events driver (C) Jiri Kosina
[    2.277687] mmc0: SDHCI controller on ACPI [80860F14:00] using ADMA
[    2.298320] wmi: Mapper loaded
[    2.323742] [drm] Initialized drm 1.1.0 20060810
[    2.331731] sdhci-pci 0000:01:00.0: SDHCI controller found [1217:8621] (rev 1)
[    2.334124] mmc1: Unknown controller version (3). You may experience problems.
[    2.336095] r8169 Gigabit Ethernet driver 2.3LK-NAPI loaded
[    2.336115] r8169 0000:03:00.0: can't disable ASPM; OS doesn't have ASPM control
[    2.343050] sdhci-pci 0000:01:00.0: No vmmc regulator found
[    2.344351] r8169 0000:03:00.0 eth0: RTL8168h/8111h at 0xffffc90000406000, 1c:83:41:09:8d:72, XID 14100800 IRQ 310
[    2.344355] r8169 0000:03:00.0 eth0: jumbo features [frames: 9200 bytes, tx checksumming: ko]
[    2.350117] sdhci-pci 0000:01:00.0: No vqmmc regulator found
[    2.353948] mmc1: SDHCI controller on PCI [0000:01:00.0] using ADMA
[    2.409610] [drm] Memory usable by graphics device = 2048M
[    2.412193] checking generic (80000000 410000) vs hw (80000000 10000000)
[    2.412198] fb: switching to inteldrmfb from EFI VGA
[    2.413631] usb 1-5: New USB device found, idVendor=04f2, idProduct=b50e
[    2.413635] usb 1-5: New USB device strings: Mfr=3, Product=1, SerialNumber=2
[    2.413637] usb 1-5: Product: Lenovo EasyCamera
[    2.413640] usb 1-5: Manufacturer: Chicony Electronics Co.,Ltd.
[    2.413642] usb 1-5: SerialNumber: 0001
[    2.424813] mmc0: MAN_BKOPS_EN bit is not set
[    2.427550] r8169 0000:03:00.0 enp3s0: renamed from eth0
[    2.431981] Console: switching to colour dummy device 80x25
[    2.432154] [drm] Replacing VGA console driver
[    2.435978] [drm] Supports vblank timestamp caching Rev 2 (21.10.2013).
[    2.435990] [drm] Driver supports precise vblank timestamp query.
[    2.445629] mmc0: new HS200 MMC card at address 0001
[    2.450993] mmcblk0: mmc0:0001 SDW64G 58.2 GiB 
[    2.451726] mmcblk0boot0: mmc0:0001 SDW64G partition 1 4.00 MiB
[    2.452506] mmcblk0boot1: mmc0:0001 SDW64G partition 2 4.00 MiB
[    2.453289] mmcblk0rpmb: mmc0:0001 SDW64G partition 3 4.00 MiB
[    2.458596]  mmcblk0: p1 p2 p3
[    2.506800] vgaarb: device changed decodes: PCI:0000:00:02.0,olddecodes=io+mem,decodes=io+mem:owns=io+mem
[    2.559591] ACPI: Video Device [GFX0] (multi-head: yes  rom: no  post: no)
[    2.560492] input: Video Bus as /devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A08:00/LNXVIDEO:00/input/input7
[    2.560649] [drm] Initialized i915 1.6.0 20151010 for 0000:00:02.0 on minor 0
[    2.762653] fbcon: inteldrmfb (fb0) is primary device
[    2.771107] tsc: Refined TSC clocksource calibration: 1599.947 MHz
[    2.771112] clocksource: tsc: mask: 0xffffffffffffffff max_cycles: 0x170ff2fc09b, max_idle_ns: 440795267654 ns
[    2.938286] psmouse serio1: synaptics: queried max coordinates: x [..5702], y [..4730]
[    2.983924] psmouse serio1: synaptics: queried min coordinates: x [1242..], y [1124..]
[    3.078951] psmouse serio1: synaptics: Touchpad model: 1, fw: 8.1, id: 0x1e2b1, caps: 0xd00423/0x840300/0x127c00/0x0, board id: 2132, fw id: 1517529
[    3.139407] input: SynPS/2 Synaptics TouchPad as /devices/platform/i8042/serio1/input/input6
[    3.772619] clocksource: Switched to clocksource tsc
[    4.425580] Console: switching to colour frame buffer device 170x48
[    4.432981] i915 0000:00:02.0: fb0: inteldrmfb frame buffer device
[    4.550906] raid6: sse2x1   gen()  1598 MB/s
[    4.618837] raid6: sse2x1   xor()  2223 MB/s
[    4.686970] raid6: sse2x2   gen()  2422 MB/s
[    4.754841] raid6: sse2x2   xor()  2472 MB/s
[    4.822836] raid6: sse2x4   gen()  3392 MB/s
[    4.890930] raid6: sse2x4   xor()  1686 MB/s
[    4.890981] raid6: using algorithm sse2x4 gen() 3392 MB/s
[    4.891035] raid6: .... xor() 1686 MB/s, rmw enabled
[    4.891084] raid6: using ssse3x2 recovery algorithm
[    4.894458] xor: measuring software checksum speed
[    4.930834]    prefetch64-sse:  6678.000 MB/sec
[    4.970845]    generic_sse:  5785.000 MB/sec
[    4.972990] xor: using function: prefetch64-sse (6678.000 MB/sec)
[    5.011302] Btrfs loaded
[    5.147916] BTRFS: device fsid 051eb2d7-2358-402b-a87c-8d7067c37512 devid 1 transid 33569 /dev/mmcblk0p2
[    5.203943] BTRFS info (device mmcblk0p2): disk space caching is enabled
[    5.206289] BTRFS: has skinny extents
[    5.226472] BTRFS: detected SSD devices, enabling SSD mode
[    5.487418] systemd[1]: Failed to insert module 'kdbus': Function not implemented
[    5.529981] systemd[1]: systemd 225 running in system mode. (+PAM +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ -LZ4 +SECCOMP +BLKID -ELFUTILS +KMOD -IDN)
[    5.535350] systemd[1]: Detected architecture x86-64.
[    5.548344] systemd[1]: Set hostname to .
[    5.729010] systemd[1]: Reached target Encrypted Volumes.
[    5.734065] systemd[1]: Created slice Root Slice.
[    5.738858] systemd[1]: Listening on /dev/initctl Compatibility Named Pipe.
[    5.743636] systemd[1]: Started Forward Password Requests to Wall Directory Watch.
[    5.748412] systemd[1]: Listening on Journal Socket.
[    5.752983] systemd[1]: Reached target User and Group Name Lookups.
[    5.757604] systemd[1]: Listening on Journal Socket (/dev/log).
[    5.762248] systemd[1]: Listening on fsck to fsckd communication Socket.
[    5.767201] systemd[1]: Set up automount Arbitrary Executable File Formats File System Automount Point.
[    5.772094] systemd[1]: Reached target Remote File Systems (Pre).
[    5.777334] systemd[1]: Created slice System Slice.
[    5.782684] systemd[1]: Created slice system-systemd\x2dfsck.slice.
[    5.803544] systemd[1]: Starting Create list of required static device nodes for the current kernel...
[    5.810869] systemd[1]: Starting Setup Virtual Console...
[    5.818240] systemd[1]: Mounting Huge Pages File System...
[    5.826059] systemd[1]: Starting Uncomplicated firewall...
[    5.833766] systemd[1]: Starting Load Kernel Modules...
[    5.841131] systemd[1]: Starting Increase datagram queue length...
[    5.847162] systemd[1]: Created slice system-getty.slice.
[    5.897553] systemd[1]: Listening on udev Kernel Socket.
[    5.916115] lp: driver loaded but no devices found
[    5.926726] ppdev: user-space parallel port driver
[    5.931246] systemd[1]: Started Braille Device Support.
[    5.940404] systemd[1]: Mounting Debug File System...
[    5.945852] systemd[1]: Listening on Journal Audit Socket.
[    5.951319] systemd[1]: Created slice User and Session Slice.
[    5.956448] systemd[1]: Reached target Slices.
[    5.963093] systemd[1]: Started Read required files in advance.
[    5.968631] systemd[1]: Listening on udev Control Socket.
[    5.975465] systemd[1]: Starting udev Coldplug all Devices...
[    5.982386] systemd[1]: Mounting POSIX Message Queue File System...
[    5.990064] systemd[1]: Mounted Debug File System.
[    5.995258] systemd[1]: Mounted POSIX Message Queue File System.
[    6.000277] systemd[1]: Mounted Huge Pages File System.
[    6.007663] systemd[1]: Started Create list of required static device nodes for the current kernel.
[    6.013202] systemd[1]: Started Setup Virtual Console.
[    6.018793] systemd[1]: Started Uncomplicated firewall.
[    6.024184] systemd[1]: Started Load Kernel Modules.
[    6.029377] systemd[1]: Started Increase datagram queue length.
[    6.035682] systemd[1]: ureadahead.service: Main process exited, code=exited, status=5/NOTINSTALLED
[    6.038888] systemd[1]: ureadahead.service: Unit entered failed state.
[    6.041264] systemd[1]: ureadahead.service: Failed with result 'exit-code'.
[    6.138833] systemd[1]: Listening on Syslog Socket.
[    6.163760] systemd[1]: Starting Journal Service...
[    6.170476] systemd[1]: Mounting FUSE Control File System...
[    6.177855] systemd[1]: Starting Apply Kernel Variables...
[    6.184811] systemd[1]: Starting Create Static Device Nodes in /dev...
[    6.191309] systemd[1]: Mounted FUSE Control File System.
[    6.197400] systemd[1]: Started Apply Kernel Variables.
[    6.213389] systemd[1]: Started Create Static Device Nodes in /dev.
[    6.235514] systemd[1]: Starting udev Kernel Device Manager...
[    6.246904] systemd[1]: Started Journal Service.
[    6.392659] BTRFS info (device mmcblk0p2): disk space caching is enabled
[    6.442943] systemd-journald[315]: Received request to flush runtime journal from PID 1
[    6.576908] dw_dmac INTL9C60:01: DesignWare DMA Controller, 8 channels
[    6.597875] ------------[ cut here ]------------
[    6.597892] WARNING: CPU: 3 PID: 376 at fs/sysfs/dir.c:31 sysfs_warn_dup+0x62/0x80()
[    6.597895] sysfs: cannot create duplicate filename '/bus/i2c/devices/i2c-DUAL250E:00'
[    6.597898] Modules linked in: sparse_keymap snd_seq 8250_fintek snd_seq_device snd_timer dw_dmac dw_dmac_core int3400_thermal acpi_thermal_rel snd dwc3 soc_button_array i2c_designware_platform(+) i2c_designware_core udc_core rfkill_gpio ulpi soundcore spi_pxa2xx_platform 8250_dw pwm_lpss_platform pwm_lpss mac_hid tpm_crb parport_pc ppdev lp parport autofs4 btrfs xor raid6_pq mmc_block i915 i2c_algo_bit drm_kms_helper psmouse syscopyarea sysfillrect sysimgblt sdhci_pci fb_sys_fops r8169 drm mii wmi video i2c_hid hid sdhci_acpi sdhci fjes pinctrl_cherryview
[    6.597958] CPU: 3 PID: 376 Comm: systemd-udevd Not tainted 4.4.0-rc8 #1
[    6.597960] Hardware name: LENOVO 80M1/Mini, BIOS C7CN24WW 08/11/2015
[    6.597964]  0000000000000000 000000001ab52af7 ffff880078217730 ffffffff813c92e4
[    6.597969]  ffff880078217778 ffff880078217768 ffffffff8107db42 ffff88007169a000
[    6.597973]  ffff88003593ac40 ffff880075306d20 ffff880075306d20 ffffffffffffffef
[    6.597977] Call Trace:
[    6.597988]  [] dump_stack+0x44/0x60
[    6.597994]  [] warn_slowpath_common+0x82/0xc0
[    6.597998]  [] warn_slowpath_fmt+0x5c/0x80
[    6.598003]  [] ? kernfs_path+0x48/0x60
[    6.598007]  [] sysfs_warn_dup+0x62/0x80
[    6.598010]  [] sysfs_do_create_link_sd.isra.2+0x9e/0xb0
[    6.598014]  [] sysfs_create_link+0x25/0x40
[    6.598020]  [] bus_add_device+0x10d/0x1f0
[    6.598024]  [] device_add+0x39e/0x680
[    6.598028]  [] device_register+0x1a/0x20
[    6.598034]  [] i2c_new_device+0x18e/0x230
[    6.598037]  [] acpi_i2c_add_device+0x1a0/0x210
[    6.598043]  [] acpi_ns_walk_namespace+0x125/0x276
[    6.598046]  [] ? i2c_sysfs_new_device+0x280/0x280
[    6.598050]  [] ? i2c_sysfs_new_device+0x280/0x280
[    6.598053]  [] acpi_walk_namespace+0xf9/0x144
[    6.598058]  [] i2c_register_adapter+0x340/0x480
[    6.598062]  [] i2c_add_adapter+0x5c/0x70
[    6.598066]  [] i2c_add_numbered_adapter+0x78/0x80
[    6.598073]  [] i2c_dw_probe+0x117/0x180 [i2c_designware_core]
[    6.598080]  [] dw_i2c_plat_probe+0x195/0x330 [i2c_designware_platform]
[    6.598085]  [] platform_drv_probe+0x3b/0x90
[    6.598089]  [] driver_probe_device+0x222/0x4a0
[    6.598092]  [] __driver_attach+0x84/0x90
[    6.598096]  [] ? driver_probe_device+0x4a0/0x4a0
[    6.598100]  [] bus_for_each_dev+0x6c/0xc0
[    6.598104]  [] driver_attach+0x1e/0x20
[    6.598108]  [] bus_add_driver+0x1eb/0x280
[    6.598111]  [] ? 0xffffffffc0422000
[    6.598115]  [] driver_register+0x60/0xe0
[    6.598119]  [] __platform_driver_register+0x36/0x40
[    6.598124]  [] dw_i2c_init_driver+0x17/0x1000 [i2c_designware_platform]
[    6.598129]  [] do_one_initcall+0xb3/0x200
[    6.598134]  [] ? kmem_cache_alloc_trace+0x16b/0x1d0
[    6.598140]  [] do_init_module+0x5f/0x1e5
[    6.598145]  [] load_module+0x21ba/0x27f0
[    6.598149]  [] ? __symbol_put+0x60/0x60
[    6.598156]  [] ? kernel_read+0x50/0x80
[    6.598160]  [] SyS_finit_module+0xb9/0xf0
[    6.598166]  [] entry_SYSCALL_64_fastpath+0x16/0x75
[    6.598169] ---[ end trace 7dcb82c9fdaba8ce ]---
[    6.598203] i2c i2c-10: Failed to register i2c client DUAL250E:00 at 0x18 (-17)
[    6.600520] i2c i2c-10: failed to add I2C device DUAL250E:00 from ACPI
[    6.681858] input: Ideapad extra buttons as /devices/pci0000:00/0000:00:1f.0/PNP0C09:00/VPC2004:00/input/input8
[    6.693088] shpchp: Standard Hot Plug PCI Controller Driver version: 0.4
[    6.711324] nfc: nfc_init: NFC Core ver 0.1
[    6.711374] NET: Registered protocol family 39
[    6.721741] snd_hda_intel 0000:00:1b.0: bound 0000:00:02.0 (ops i915_audio_component_bind_ops [i915])
[    6.758907] media: Linux media interface: v0.10
[    6.782830] snd_hda_codec_generic hdaudioC0D0: autoconfig for Generic: line_outs=1 (0x14/0x0/0x0/0x0/0x0) type:speaker
[    6.782840] snd_hda_codec_generic hdaudioC0D0:    speaker_outs=0 (0x0/0x0/0x0/0x0/0x0)
[    6.782844] snd_hda_codec_generic hdaudioC0D0:    hp_outs=1 (0x21/0x0/0x0/0x0/0x0)
[    6.782848] snd_hda_codec_generic hdaudioC0D0:    mono: mono_out=0x0
[    6.782850] snd_hda_codec_generic hdaudioC0D0:    inputs:
[    6.782855] snd_hda_codec_generic hdaudioC0D0:      Mic=0x19
[    6.782859] snd_hda_codec_generic hdaudioC0D0:      Internal Mic=0x12
[    6.786237] Intel(R) Wireless WiFi driver for Linux
[    6.786244] Copyright(c) 2003- 2015 Intel Corporation
[    6.794119] Linux video capture interface: v2.00
[    6.801809] iwlwifi 0000:02:00.0: Direct firmware load for iwlwifi-3160-17.ucode failed with error -2
[    6.801882] iwlwifi 0000:02:00.0: Direct firmware load for iwlwifi-3160-16.ucode failed with error -2
[    6.801920] iwlwifi 0000:02:00.0: Direct firmware load for iwlwifi-3160-15.ucode failed with error -2
[    6.801951] iwlwifi 0000:02:00.0: Direct firmware load for iwlwifi-3160-14.ucode failed with error -2
[    6.811950] input: HDA Intel PCH Mic as /devices/pci0000:00/0000:00:1b.0/sound/card0/input9
[    6.812098] input: HDA Intel PCH Headphone as /devices/pci0000:00/0000:00:1b.0/sound/card0/input10
[    6.812228] input: HDA Intel PCH HDMI/DP,pcm=3 as /devices/pci0000:00/0000:00:1b.0/sound/card0/input11
[    6.816560] iwlwifi 0000:02:00.0: loaded firmware version 25.30.13.0 op_mode iwlmvm
[    6.863699] uvcvideo: Found UVC 1.00 device Lenovo EasyCamera (04f2:b50e)
[    6.877915] input: Lenovo EasyCamera as /devices/pci0000:00/0000:00:14.0/usb1/1-5/1-5:1.0/input/input12
[    6.881023] iwlwifi 0000:02:00.0: Detected Intel(R) Dual Band Wireless AC 3160, REV=0x164
[    6.881134] iwlwifi 0000:02:00.0: L1 Enabled - LTR Enabled
[    6.881418] iwlwifi 0000:02:00.0: L1 Enabled - LTR Enabled
[    6.882778] usbcore: registered new interface driver uvcvideo
[    6.882792] USB Video Class driver (1.1.1)
[    6.917635] SSE version of gcm_enc/dec engaged.
[    6.955343] Adding 3998716k swap on /dev/mmcblk0p3.  Priority:-1 extents:1 across:3998716k SSFS
[    7.025826] asus_wmi: Asus Management GUID not found
[    7.029610] ieee80211 phy0: Selected rate control algorithm 'iwl-mvm-rs'
[    7.111701] input: ATML1000:00 03EB:8C3C as /devices/pci0000:00/808622C1:02/i2c-11/i2c-ATML1000:00/0018:03EB:8C3C.0001/input/input13
[    7.116117] hid-multitouch 0018:03EB:8C3C.0001: input,hidraw0: I2C HID v1.00 Device [ATML1000:00 03EB:8C3C] on i2c-ATML1000:00
[    7.160762] iwlwifi 0000:02:00.0 wlp2s0: renamed from wlan0
[    7.180210] cfg80211: World regulatory domain updated:
[    7.180220] cfg80211:  DFS Master region: unset
[    7.180223] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[    7.180229] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[    7.180232] cfg80211:   (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[    7.180235] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[    7.180239] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[    7.180242] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[    7.180246] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[    7.180248] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[    7.180251] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[    7.183875] intel_rapl: Found RAPL domain package
[    7.183885] intel_rapl: Found RAPL domain core
[    7.398659] audit: type=1400 audit(1453489165.818:2): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/usr/lib/lightdm/lightdm-guest-session&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.398672] audit: type=1400 audit(1453489165.818:3): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;chromium&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.408993] audit: type=1400 audit(1453489165.826:4): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/sbin/dhclient&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.409011] audit: type=1400 audit(1453489165.826:5): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/usr/lib/NetworkManager/nm-dhcp-client.action&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.409021] audit: type=1400 audit(1453489165.826:6): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/usr/lib/NetworkManager/nm-dhcp-helper&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.409030] audit: type=1400 audit(1453489165.826:7): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/usr/lib/connman/scripts/dhclient-script&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.440495] audit: type=1400 audit(1453489165.858:8): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/usr/bin/evince&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.440514] audit: type=1400 audit(1453489165.858:9): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;sanitized_helper&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.440524] audit: type=1400 audit(1453489165.858:10): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;/usr/bin/evince-previewer&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.440533] audit: type=1400 audit(1453489165.858:11): apparmor=&quot;STATUS&quot; operation=&quot;profile_load&quot; name=&quot;sanitized_helper&quot; pid=573 comm=&quot;apparmor_parser&quot;
[    7.651170] ip_tables: (C) 2000-2006 Netfilter Core Team
[    7.708090] ip6_tables: (C) 2000-2006 Netfilter Core Team
[    8.018800] cgroup: new mount options do not match the existing superblock, will be ignored
[    8.197483] random: nonblocking pool is initialized
[    8.507711] IPv6: ADDRCONF(NETDEV_UP): wlp2s0: link is not ready
[    8.508059] iwlwifi 0000:02:00.0: L1 Enabled - LTR Enabled
[    8.508320] iwlwifi 0000:02:00.0: L1 Enabled - LTR Enabled
[    8.619124] iwlwifi 0000:02:00.0: L1 Enabled - LTR Enabled
[    8.619428] iwlwifi 0000:02:00.0: L1 Enabled - LTR Enabled
[    8.637937] IPv6: ADDRCONF(NETDEV_UP): wlp2s0: link is not ready
[    8.642440] IPv6: ADDRCONF(NETDEV_UP): enp3s0: link is not ready
[    8.669334] r8169 0000:03:00.0 enp3s0: link down
[    8.669534] IPv6: ADDRCONF(NETDEV_UP): enp3s0: link is not ready
[    8.808362] IPv6: ADDRCONF(NETDEV_UP): wlp2s0: link is not ready
[   12.240072] wlp2s0: authenticate with 04:f0:21:1c:bb:b9
[   12.248561] wlp2s0: send auth to 04:f0:21:1c:bb:b9 (try 1/3)
[   12.456310] wlp2s0: send auth to 04:f0:21:1c:bb:b9 (try 2/3)
[   12.458208] wlp2s0: authenticated
[   12.462791] wlp2s0: associate with 04:f0:21:1c:bb:b9 (try 1/3)
[   12.469332] wlp2s0: RX AssocResp from 04:f0:21:1c:bb:b9 (capab=0x411 status=0 aid=2)
[   12.473833] wlp2s0: associated
[   12.473927] IPv6: ADDRCONF(NETDEV_CHANGE): wlp2s0: link becomes ready
[   12.539664] cfg80211: Regulatory domain changed to country: CZ
[   12.539672] cfg80211:  DFS Master region: ETSI
[   12.539675] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   12.539679] cfg80211:   (2400000 KHz - 2483500 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   12.539683] cfg80211:   (5150000 KHz - 5250000 KHz @ 80000 KHz, 200000 KHz AUTO), (N/A, 2301 mBm), (N/A)
[   12.539686] cfg80211:   (5250000 KHz - 5350000 KHz @ 80000 KHz, 200000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[   12.539690] cfg80211:   (5470000 KHz - 5725000 KHz @ 160000 KHz), (N/A, 2698 mBm), (0 s)
[   12.539693] cfg80211:   (57000000 KHz - 66000000 KHz @ 2160000 KHz), (N/A, 4000 mBm), (N/A)
</code></pre>
<h3 id="dmidecode"><a class="toclink" href="2016/01/22/2016-01-linux-lenovo-yoga-300-11ibr/#dmidecode">dmidecode</a></h3>
<pre><code># dmidecode 2.12
# SMBIOS entry point at 0x79eb3000
SMBIOS 2.8 present.
52 structures occupying 2329 bytes.
Table at 0x7A44E000.

Handle 0x0000, DMI type 0, 24 bytes
BIOS Information
 Vendor: LENOVO
 Version: C7CN24WW
 Release Date: 08/11/2015
 Address: 0xF0000
 Runtime Size: 64 kB
 ROM Size: 3072 kB
 Characteristics:
  PCI is supported
  BIOS is upgradeable
  BIOS shadowing is allowed
  Boot from CD is supported
  Selectable boot is supported
  EDD is supported
  8042 keyboard services are supported (int 9h)
  Serial services are supported (int 14h)
  Printer services are supported (int 17h)
  CGA/mono video services are supported (int 10h)
  ACPI is supported
  USB legacy is supported
  ATAPI Zip drive boot is supported
  BIOS boot specification is supported
  Function key-initiated network boot is supported
  Targeted content distribution is supported
  UEFI is supported
 BIOS Revision: 1.24
 Firmware Revision: 1.24

Handle 0x0001, DMI type 1, 27 bytes
System Information
 Manufacturer: LENOVO
 Product Name: 80M1
 Version: Lenovo Yoga 300-11IBR
 Serial Number: P2009YWF
 UUID: D276A2D9-FACF-4DAA-B5A1-B5C4E7F7BA84
 Wake-up Type: Power Switch
 SKU Number: LENOVO_MT_80M1_BU_idea_FM_Lenovo Yoga 300-11IBR
 Family: IDEAPAD

Handle 0x0002, DMI type 2, 17 bytes
Base Board Information
 Manufacturer: LENOVO
 Product Name: Mini
 Version: SDK0J91175WIN
 Serial Number: P2009YWF
 Asset Tag: No Asset Tag
 Features:
  Board is a hosting board
  Board is replaceable
 Location In Chassis: Board Chassis Location
 Chassis Handle: 0x0003
 Type: Motherboard
 Contained Object Handles: 0

Handle 0x0003, DMI type 3, 25 bytes
Chassis Information
 Manufacturer: LENOVO
 Type: Notebook
 Lock: Not Present
 Version: Lenovo Yoga 300-11IBR
 Serial Number: P2009YWF
 Asset Tag: No Asset Tag
 Boot-up State: Safe
 Power Supply State: Safe
 Thermal State: Safe
 Security Status: None
 OEM Information: 0x00000000
 Height: Unspecified
 Number Of Power Cords: 1
 Contained Elements: 0
 SKU Number: Chassis SKU

Handle 0x0004, DMI type 4, 42 bytes
Processor Information
 Socket Designation: CHV
 Type: Central Processor
 Family: Celeron
 Manufacturer: Intel(R) Corporation
 ID: C3 06 04 00 FF FB EB BF
 Signature: Type 0, Family 6, Model 76, Stepping 3
 Flags:
  FPU (Floating-point unit on-chip)
  VME (Virtual mode extension)
  DE (Debugging extension)
  PSE (Page size extension)
  TSC (Time stamp counter)
  MSR (Model specific registers)
  PAE (Physical address extension)
  MCE (Machine check exception)
  CX8 (CMPXCHG8 instruction supported)
  APIC (On-chip APIC hardware supported)
  SEP (Fast system call)
  MTRR (Memory type range registers)
  PGE (Page global enable)
  MCA (Machine check architecture)
  CMOV (Conditional move instruction supported)
  PAT (Page attribute table)
  PSE-36 (36-bit page size extension)
  CLFSH (CLFLUSH instruction supported)
  DS (Debug store)
  ACPI (ACPI supported)
  MMX (MMX technology supported)
  FXSR (FXSAVE and FXSTOR instructions supported)
  SSE (Streaming SIMD extensions)
  SSE2 (Streaming SIMD extensions 2)
  SS (Self-snoop)
  HTT (Multi-threading)
  TM (Thermal monitor supported)
  PBE (Pending break enabled)
 Version: Intel(R) Celeron(R) CPU  N3150  @ 1.60GHz
 Voltage: 4.0 V
 External Clock: 83 MHz
 Max Speed: 1660 MHz
 Current Speed: 1600 MHz
 Status: Populated, Enabled
 Upgrade: Slot 1
 L1 Cache Handle: 0x0006
 L2 Cache Handle: 0x0007
 L3 Cache Handle: Not Provided
 Serial Number: To Be Filled By O.E.M.
 Asset Tag: To Be Filled By O.E.M.
 Part Number: To Be Filled By O.E.M.
 Core Count: 4
 Core Enabled: 4
 Thread Count: 4
 Characteristics:
  64-bit capable
  Multi-Core
  Execute Protection
  Enhanced Virtualization
  Power/Performance Control

Handle 0x0005, DMI type 7, 19 bytes
Cache Information
 Socket Designation: L1 Cache
 Configuration: Enabled, Not Socketed, Level 1
 Operational Mode: Write Back
 Location: Internal
 Installed Size: 24 kB
 Maximum Size: 24 kB
 Supported SRAM Types:
  Synchronous
 Installed SRAM Type: Synchronous
 Speed: Unknown
 Error Correction Type: Parity
 System Type: Data
 Associativity: Other

Handle 0x0006, DMI type 7, 19 bytes
Cache Information
 Socket Designation: L1 Cache
 Configuration: Enabled, Not Socketed, Level 1
 Operational Mode: Write Back
 Location: Internal
 Installed Size: 32 kB
 Maximum Size: 32 kB
 Supported SRAM Types:
  Synchronous
 Installed SRAM Type: Synchronous
 Speed: Unknown
 Error Correction Type: Parity
 System Type: Instruction
 Associativity: 8-way Set-associative

Handle 0x0007, DMI type 7, 19 bytes
Cache Information
 Socket Designation: L2 Cache
 Configuration: Enabled, Not Socketed, Level 2
 Operational Mode: Write Back
 Location: Internal
 Installed Size: 1024 kB
 Maximum Size: 1024 kB
 Supported SRAM Types:
  Synchronous
 Installed SRAM Type: Synchronous
 Speed: Unknown
 Error Correction Type: Single-bit ECC
 System Type: Unified
 Associativity: 16-way Set-associative

Handle 0x0008, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J1A2
 Internal Connector Type: None
 External Reference Designator: USB2.0
 External Connector Type: Access Bus (USB)
 Port Type: USB

Handle 0x0009, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J1A2
 Internal Connector Type: None
 External Reference Designator: USB2.0
 External Connector Type: Access Bus (USB)
 Port Type: USB

Handle 0x000A, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J2A2
 Internal Connector Type: None
 External Reference Designator: USB3.0 Port0
 External Connector Type: Access Bus (USB)
 Port Type: USB

Handle 0x000B, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J9D1
 Internal Connector Type: None
 External Reference Designator: UART to Micro USB
 External Connector Type: Access Bus (USB)
 Port Type: USB

Handle 0x000C, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: CON6A1
 Internal Connector Type: None
 External Reference Designator: SD Card
 External Connector Type: Other
 Port Type: Other

Handle 0x000D, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J9B1
 Internal Connector Type: None
 External Reference Designator: Keyboard
 External Connector Type: PS/2
 Port Type: Keyboard Port

Handle 0x000E, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J9B1
 Internal Connector Type: None
 External Reference Designator: Mouse
 External Connector Type: PS/2
 Port Type: Mouse Port

Handle 0x000F, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J5A1
 Internal Connector Type: None
 External Reference Designator: Microphone
 External Connector Type: Mini Jack (headphones)
 Port Type: Audio Port

Handle 0x0010, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J5A1
 Internal Connector Type: None
 External Reference Designator: Line In
 External Connector Type: Mini Jack (headphones)
 Port Type: Audio Port

Handle 0x0011, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J5A1
 Internal Connector Type: None
 External Reference Designator: Line Out
 External Connector Type: Mini Jack (headphones)
 Port Type: Audio Port

Handle 0x0012, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J7A1
 Internal Connector Type: None
 External Reference Designator: Audio Jack
 External Connector Type: Mini Jack (headphones)
 Port Type: Audio Port

Handle 0x0013, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J2A2
 Internal Connector Type: None
 External Reference Designator: Network Rj45 Jack
 External Connector Type: RJ-45
 Port Type: Network Port

Handle 0x0014, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J4J1
 Internal Connector Type: None
 External Reference Designator: SATA
 External Connector Type: SAS/SATA Plug Receptacle
 Port Type: Other

Handle 0x0015, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J4E2
 Internal Connector Type: SAS/SATA Plug Receptacle
 External Reference Designator: SATA Cable
 External Connector Type: None
 Port Type: Other

Handle 0x0016, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J4A1
 Internal Connector Type: None
 External Reference Designator: VGA
 External Connector Type: DB-15 female
 Port Type: Video Port

Handle 0x0017, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J1A1
 Internal Connector Type: None
 External Reference Designator: Display Port
 External Connector Type: Other
 Port Type: Video Port

Handle 0x0018, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J3A1
 Internal Connector Type: None
 External Reference Designator: Display Port
 External Connector Type: Other
 Port Type: Video Port

Handle 0x0019, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J9B4
 Internal Connector Type: None
 External Reference Designator: Serial Port
 External Connector Type: DB-9 male
 Port Type: Serial Port 16550A Compatible

Handle 0x001A, DMI type 8, 9 bytes
Port Connector Information
 Internal Reference Designator: J2A1
 Internal Connector Type: None
 External Reference Designator: HDMI
 External Connector Type: Other
 Port Type: Other

Handle 0x001B, DMI type 9, 17 bytes
System Slot Information
 Designation: J5C1
 Type: x4 PCI Express x4
 Current Usage: Available
 Length: Other
 ID: 0
 Characteristics:
  PME signal is supported
  Hot-plug devices are supported
  SMBus signal is supported
 Bus Address: 0000:00:00.0

Handle 0x001C, DMI type 9, 17 bytes
System Slot Information
 Designation: J4B3
 Type: x1 PCI Express x1
 Current Usage: Available
 Length: Other
 ID: 0
 Characteristics:
  PME signal is supported
  Hot-plug devices are supported
  SMBus signal is supported
 Bus Address: 0000:00:00.0

Handle 0x001D, DMI type 9, 17 bytes
System Slot Information
 Designation: J6C1
 Type: x1 PCI Express x1
 Current Usage: Available
 Length: Other
 ID: 0
 Characteristics:
  PME signal is supported
  Hot-plug devices are supported
  SMBus signal is supported
 Bus Address: 0000:00:00.0

Handle 0x001E, DMI type 9, 17 bytes
System Slot Information
 Designation: J6D1
 Type: x1 PCI Express x1
 Current Usage: Available
 Length: Other
 ID: 0
 Characteristics:
  PME signal is supported
  Hot-plug devices are supported
  SMBus signal is supported
 Bus Address: 0000:00:00.0

Handle 0x001F, DMI type 11, 5 bytes
OEM Strings
 String 1: Insyde Chipset

Handle 0x0020, DMI type 12, 5 bytes
System Configuration Options
 Option 1: String1 for Type12 Equipment Manufacturer
 Option 2: String2 for Type12 Equipment Manufacturer
 Option 3: String3 for Type12 Equipment Manufacturer
 Option 4: String4 for Type12 Equipment Manufacturer

Handle 0x0021, DMI type 13, 22 bytes
BIOS Language Information
 Language Description Format: Long
 Installable Languages: 8
  en|US|iso8859-1,0
  fr|CA|iso8859-1,0
  zh|TW|unicode,0
  ja|JP|unicode,0
  it|IT|iso8859-1,0
  es|ES|iso8859-1,0
  de|DE|iso8859-1,0
  pt|PT|iso8859-1,0
 Currently Installed Language: en|US|iso8859-1,0

Handle 0x0022, DMI type 15, 29 bytes
System Event Log
 Area Length: 0 bytes
 Header Start Offset: 0x0000
 Header Length: 8192 bytes
 Data Start Offset: 0x2000
 Access Method: General-purpose non-volatile data functions
 Access Address: 0x0000
 Status: Valid, Not Full
 Change Token: 0x12345678
 Header Format: OEM-specific
 Supported Log Type Descriptors: 0

Handle 0x0023, DMI type 16, 23 bytes
Physical Memory Array
 Location: System Board Or Motherboard
 Use: System Memory
 Error Correction Type: None
 Maximum Capacity: 8 GB
 Error Information Handle: No Error
 Number Of Devices: 2

Handle 0x0024, DMI type 17, 40 bytes
Memory Device
 Array Handle: 0x0023
 Error Information Handle: No Error
 Total Width: 8 bits
 Data Width: 8 bits
 Size: 2048 MB
 Form Factor: SODIMM
 Set: None
 Locator: ChannelA-DIMM0
 Bank Locator: BANK 0
 Type: DDR3
 Type Detail: Synchronous
 Speed: 1600 MHz
 Manufacturer: Micron
 Serial Number: 34000000
 Asset Tag: 9876543210
 Part Number:                   
 Rank: Unknown
 Configured Clock Speed: 1600 MHz
 Minimum voltage:  1.500 V
 Maximum voltage:  1.500 V
 Configured voltage:  Unknown

Handle 0x0025, DMI type 19, 31 bytes
Memory Array Mapped Address
 Starting Address: 0x00000000000
 Ending Address: 0x0007FFFFFFF
 Range Size: 2 GB
 Physical Array Handle: 0x0023
 Partition Width: 2

Handle 0x0026, DMI type 20, 35 bytes
Memory Device Mapped Address
 Starting Address: 0x00000000000
 Ending Address: 0x0007FFFFFFF
 Range Size: 2 GB
 Physical Device Handle: 0x0024
 Memory Array Mapped Address Handle: 0x0025
 Partition Row Position: Unknown
 Interleave Position: 1
 Interleaved Data Depth: 1

Handle 0x0027, DMI type 21, 7 bytes
Built-in Pointing Device
 Type: Touch Pad
 Interface: PS/2
 Buttons: 2

Handle 0x0028, DMI type 22, 26 bytes
Portable Battery
 Location: I2C2
 Manufacturer: Intel SR 1
 Manufacture Date: Date
 Serial Number: 123456789
 Name: SR Real Battery
 Chemistry: Lithium Ion
 Design Capacity: 0 mWh
 Design Voltage: 3750 mV
 SBDS Version: CRB Battery 0
 Maximum Error: Unknown
 OEM-specific Information: 0x00000000

Handle 0x0029, DMI type 24, 5 bytes
Hardware Security
 Power-On Password Status: Disabled
 Keyboard Password Status: Disabled
 Administrator Password Status: Enabled
 Front Panel Reset Status: Disabled

Handle 0x002A, DMI type 26, 24 bytes
Voltage Probe
 Description: Voltage Probe Description
 Location: 
 Status: 
 Maximum Value: Unknown
 Minimum Value: Unknown
 Resolution: Unknown
 Tolerance: Unknown
 Accuracy: Unknown
 OEM-specific Information: 0x00008000
 Nominal Value: 0.000 V

Handle 0x002B, DMI type 27, 15 bytes
Cooling Device
 Temperature Probe Handle: 0x002C
 Type: Chip Fan
 Status: OK
 OEM-specific Information: 0x00000000
 Nominal Speed: Unknown Or Non-rotating
 Description: Cooling Device Description

Handle 0x002C, DMI type 28, 24 bytes
Temperature Probe
 Description: Temperature Probe Description
 Location: Unknown
 Status: Unknown
 Maximum Value: Unknown
 Minimum Value: Unknown
 Resolution: Unknown
 Tolerance: Unknown
 Accuracy: Unknown
 OEM-specific Information: 0x00008000
 Nominal Value: 0.0 deg C

Handle 0x002D, DMI type 32, 11 bytes
System Boot Information
 Status: No errors detected

Handle 0x002E, DMI type 39, 22 bytes
System Power Supply
 Location: OEM Define 0
 Name: OEM Define 1
 Manufacturer: OEM Define 2
 Serial Number: OEM Define 3
 Asset Tag: OEM Define 4
 Model Part Number: OEM Define 5
 Revision: OEM Define 6
 Max Power Capacity: 75 W
 Status: Present, OK
 Type: Regulator
 Input Voltage Range Switching: Auto-switch
 Plugged: No
 Hot Replaceable: No

Handle 0x002F, DMI type 41, 11 bytes
Onboard Device
 Reference Designation: IGD
 Type: Video
 Status: Disabled
 Type Instance: 1
 Bus Address: 0000:00:02.0

Handle 0x0030, DMI type 131, 64 bytes
OEM-specific Type
 Header and Data:
  83 40 30 00 00 00 00 00 00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00 76 50 72 6F 00 00 00 00

Handle 0x0031, DMI type 133, 5 bytes
OEM-specific Type
 Header and Data:
  85 05 31 00 01
 Strings:
  KHOIHGIUCCHHII

Handle 0x0032, DMI type 200, 16 bytes
OEM-specific Type
 Header and Data:
  C8 10 32 00 01 02 01 22 01 11 01 45 B2 80 01 22
 Strings:
  IdeaPad
  80M1001LCK
  .....ptal..+.P

Handle 0xFEFF, DMI type 127, 4 bytes
End Of Table
</code></pre>
<p>I would appreciate any pointers to resources or help with solving the problems. Though even with that problems I like this laptop.</p>
<hr />
<h3 id="2-comments-captured-from-original-post-on-blogger"><a class="toclink" href="2016/01/22/2016-01-linux-lenovo-yoga-300-11ibr/#2-comments-captured-from-original-post-on-blogger">2 comments captured from <a href="https://snarkybrill.blogspot.com/2016/01/linux-lenovo-yoga-300-11ibr.html">original post</a> on Blogger</a></h3>
<p><strong>Unknown said on 2016-08-31</strong></p>
<p>Any way to fix the screen flickering at lower brightness levels?</p>
<p><strong>Tomas Hlavacek said on 2016-09-06</strong></p>
<p>Hi Rochelle!<br /><br />Well, it seems that my laptop does not suffer from any visible screen flickering...<br /><br />But I have a problem with hissing and cracking sounds coming out from the laptop when there is external power connected and the battery is fully charged. And I also had an intermittent problem with eMMC that repeatedly failed. Probably due to poor soldering, so I used hot air to reflow the solder and it haven't done it again since then.<br /><br />So... Who knows. Perhaps it is simply poor-quality laptop. Who would expect that kind of problems in 2015/2016 in Lenovo product? :-(<br /><br />Anyway, I am buying Dell XPS 13 with Skylake i5, because I can't stand the Lenovo problems and it is actually quite slow even though I am using minimalist Linux distro there.</p>
    
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <span class="md-pagination__current">1</span> <a class="md-pagination__link" href="page/2/">2</a> <a class="md-pagination__link" href="page/3/">3</a> <a class="md-pagination__link" href="page/4/">4</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>